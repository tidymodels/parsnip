<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Logistic regression via generalized estimating equations (GEE) — details_logistic_reg_gee • parsnip</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logistic regression via generalized estimating equations (GEE) — details_logistic_reg_gee"><meta name="description" content="gee::gee() uses generalized least squares to fit different types of models
with errors that are not independent."><meta property="og:description" content="gee::gee() uses generalized least squares to fit different types of models
with errors that are not independent."><meta property="og:image" content="https://parsnip.tidymodels.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/parsnip.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/checklists.html">Dev checklists</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a></li>
    <li><a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more"><li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Logistic regression via generalized estimating equations (GEE)</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/main/R/logistic_reg_gee.R" class="external-link"><code>R/logistic_reg_gee.R</code></a></small>
      <div class="d-none name"><code>details_logistic_reg_gee.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>gee::gee()</code> uses generalized least squares to fit different types of models
with errors that are not independent.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For this engine, there is a single mode: classification</p><div class="section">
<h3 id="tuning-parameters">Tuning Parameters<a class="anchor" aria-label="anchor" href="#tuning-parameters"></a></h3>


<p>This model has no formal tuning parameters. It may be beneficial to
determine the appropriate correlation structure to use, but this
typically does not affect the predicted value of the model. It <em>does</em>
have an effect on the inferential results and parameter covariance
values.</p>
</div>

<div class="section">
<h3 id="translation-from-parsnip-to-the-original-package">Translation from parsnip to the original package<a class="anchor" aria-label="anchor" href="#translation-from-parsnip-to-the-original-package"></a></h3>


<p>The <strong>multilevelmod</strong> extension package is required to fit this model.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/multilevelmod" class="external-link">multilevelmod</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"gee"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/translate.html">translate</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="do">## Logistic Regression Model Specification (classification)</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="do">## Computational engine: gee</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="do">## Model fit template:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="do">## multilevelmod::gee_fit(formula = missing_arg(), data = missing_arg(),</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="do">##     family = binomial)</span></span></code></pre><p></p></div>
<p><code>multilevelmod::gee_fit()</code> is a wrapper model around <code>gee::gee()</code>.</p>
</div>

<div class="section">
<h3 id="preprocessing-requirements">Preprocessing requirements<a class="anchor" aria-label="anchor" href="#preprocessing-requirements"></a></h3>


<p>There are no specific preprocessing needs. However, it is helpful to
keep the clustering/subject identifier column as factor or character
(instead of making them into dummy variables). See the examples in the
next section.</p>
</div>

<div class="section">
<h3 id="other-details">Other details<a class="anchor" aria-label="anchor" href="#other-details"></a></h3>


<p>The model cannot accept case weights.</p>
<p>Both <code>gee:gee()</code> and <code>gee:geepack()</code> specify the id/cluster variable
using an argument <code>id</code> that requires a vector. parsnip doesn’t work that
way so we enable this model to be fit using a artificial function
<code>id_var()</code> to be used in the formula. So, in the original package, the
call would look like:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">gee</span><span class="op">(</span><span class="va">breaks</span> <span class="op">~</span> <span class="va">tension</span>, id <span class="op">=</span> <span class="va">wool</span>, data <span class="op">=</span> <span class="va">warpbreaks</span>, corstr <span class="op">=</span> <span class="st">"exchangeable"</span><span class="op">)</span></span></code></pre><p></p></div>
<p>With <code>parsnip</code>, we suggest using the formula method when fitting:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"toenail"</span>, package <span class="op">=</span> <span class="st">"HSAUR3"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"gee"</span>, corstr <span class="op">=</span> <span class="st">"exchangeable"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">outcome</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">*</span> <span class="va">visit</span> <span class="op">+</span> <span class="fu">id_var</span><span class="op">(</span><span class="va">patientID</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">toenail</span><span class="op">)</span></span></code></pre><p></p></div>
<p>When using tidymodels infrastructure, it may be better to use a
workflow. In this case, you can add the appropriate columns using
<code>add_variables()</code> then supply the GEE formula when adding the model:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">gee_spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"gee"</span>, corstr <span class="op">=</span> <span class="st">"exchangeable"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gee_wflow</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># The data are included as-is using:</span></span>
<span>  <span class="fu">add_variables</span><span class="op">(</span>outcomes <span class="op">=</span> <span class="va">outcome</span>, predictors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="va">visit</span>, <span class="va">patientID</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">add_model</span><span class="op">(</span><span class="va">gee_spec</span>, formula <span class="op">=</span> <span class="va">outcome</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">*</span> <span class="va">visit</span> <span class="op">+</span> <span class="fu">id_var</span><span class="op">(</span><span class="va">patientID</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">gee_wflow</span>, data <span class="op">=</span> <span class="va">toenail</span><span class="op">)</span></span></code></pre><p></p></div>
<p>The <code>gee::gee()</code> function always prints out warnings and output even
when <code>silent = TRUE</code>. The parsnip <code>"gee"</code> engine, by contrast, silences
all console output coming from <code>gee::gee()</code>, even if <code>silent = FALSE</code>.</p>
<p>Also, because of issues with the <code>gee()</code> function, a supplementary call
to <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm()</a></code> is needed to get the rank and QR decomposition objects so
that <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> can be used.</p>
</div>

<div class="section">
<h3 id="case-weights">Case weights<a class="anchor" aria-label="anchor" href="#case-weights"></a></h3>


<p>The underlying model implementation does not allow for case weights.</p>
</div>

<div class="section">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h3>

<ul><li><p>Liang, K.Y. and Zeger, S.L. (1986) Longitudinal data analysis using
generalized linear models. <em>Biometrika</em>, 73 13–22.</p></li>
<li><p>Zeger, S.L. and Liang, K.Y. (1986) Longitudinal data analysis for
discrete and continuous outcomes. <em>Biometrics</em>, 42 121–130.</p></li>
</ul></div>

    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

