<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Model Specifications — model_spec • parsnip</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model Specifications — model_spec"><meta name="description" content="The parsnip package splits the process of fitting models into two steps:
Specify how a model will be fit using a model specification
Fit a model using the model specification


This is a different approach to many other model interfaces in R, like lm(),
where both the specification of the model and the fitting happens in one
function call. Splitting the process into two steps allows users to
iteratively define model specifications throughout the model development
process.
This intermediate object that defines how the model will be fit is called
a model specification and has class model_spec. Model type functions,
like linear_reg() or boost_tree(), return model_spec objects.
Fitted model objects, resulting from passing a model_spec to
fit() or fit_xy, have
class model_fit, and contain the original model_spec objects inside
them. See ?model_fit for more on that object type, and
?extract_spec_parsnip to
extract model_specs from model_fits."><meta property="og:description" content="The parsnip package splits the process of fitting models into two steps:
Specify how a model will be fit using a model specification
Fit a model using the model specification


This is a different approach to many other model interfaces in R, like lm(),
where both the specification of the model and the fitting happens in one
function call. Splitting the process into two steps allows users to
iteratively define model specifications throughout the model development
process.
This intermediate object that defines how the model will be fit is called
a model specification and has class model_spec. Model type functions,
like linear_reg() or boost_tree(), return model_spec objects.
Fitted model objects, resulting from passing a model_spec to
fit() or fit_xy, have
class model_fit, and contain the original model_spec objects inside
them. See ?model_fit for more on that object type, and
?extract_spec_parsnip to
extract model_specs from model_fits."><meta property="og:image" content="https://parsnip.tidymodels.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/parsnip.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/checklists.html">Dev checklists</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a></li>
    <li><a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more"><li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model Specifications</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/main/R/model_object_docs.R" class="external-link"><code>R/model_object_docs.R</code></a></small>
      <div class="d-none name"><code>model_spec.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The parsnip package splits the process of fitting models into two steps:</p><ol><li><p>Specify how a model will be fit using a <em>model specification</em></p></li>
<li><p>Fit a model using the model specification</p></li>
</ol><p>This is a different approach to many other model interfaces in R, like <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>,
where both the specification of the model and the fitting happens in one
function call. Splitting the process into two steps allows users to
iteratively define model specifications throughout the model development
process.</p>
<p>This intermediate object that defines how the model will be fit is called
a <em>model specification</em> and has class <code>model_spec</code>. Model type functions,
like <code><a href="linear_reg.html">linear_reg()</a></code> or <code><a href="boost_tree.html">boost_tree()</a></code>, return <code>model_spec</code> objects.</p>
<p>Fitted model objects, resulting from passing a <code>model_spec</code> to
<a href="fit.html">fit()</a> or <a href="fit.html">fit_xy</a>, have
class <code>model_fit</code>, and contain the original <code>model_spec</code> objects inside
them. See <a href="model_fit.html">?model_fit</a> for more on that object type, and
<a href="extract-parsnip.html">?extract_spec_parsnip</a> to
extract <code>model_spec</code>s from <code>model_fit</code>s.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An object with class <code>"model_spec"</code> is a container for
information about a model that will be fit.</p>
<p>The main elements of the object are:</p><ul><li><p><code>args</code>: A vector of the main arguments for the model. The
names of these arguments may be different from their
counterparts n the underlying model function. For example, for a
<code>glmnet</code> model, the argument name for the amount of the penalty
is called "penalty" instead of "lambda" to make it more general
and usable across different types of models (and to not be
specific to a particular model function). The elements of <code>args</code>
can <code><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune()</a></code> with the use of the
<a href="https://tune.tidymodels.org/" class="external-link">tune package</a>. For more information
see <a href="https://www.tidymodels.org/start/tuning/" class="external-link">https://www.tidymodels.org/start/tuning/</a>. If left to their
defaults (<code>NULL</code>), the
arguments will use the underlying model functions default value.
As discussed below, the arguments in <code>args</code> are captured as
quosures and are not immediately executed.</p></li>
<li><p><code>...</code>: Optional model-function-specific
parameters. As with <code>args</code>, these will be quosures and can be
<code><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune()</a></code>.</p></li>
<li><p><code>mode</code>: The type of model, such as "regression" or
"classification". Other modes will be added once the package
adds more functionality.</p></li>
<li><p><code>method</code>: This is a slot that is filled in later by the
model's constructor function. It generally contains lists of
information that are used to create the fit and prediction code
as well as required packages and similar data.</p></li>
<li><p><code>engine</code>: This character string declares exactly what
software will be used. It can be a package name or a technology
type.</p></li>
</ul><p>This class and structure is the basis for how parsnip
stores model objects prior to seeing the data.</p>
    </div>
    <div class="section level2">
    <h2 id="argument-details">Argument Details<a class="anchor" aria-label="anchor" href="#argument-details"></a></h2>



<p>An important detail to understand when creating model
specifications is that they are intended to be functionally
independent of the data. While it is true that some tuning
parameters are <em>data dependent</em>, the model specification does
not interact with the data at all.</p>
<p>For example, most R functions immediately evaluate their
arguments. For example, when calling <code>mean(dat_vec)</code>, the object
<code>dat_vec</code> is immediately evaluated inside of the function.</p>
<p>parsnip model functions do not do this. For example, using</p>
<div class="sourceCode"><pre><code><span></span>
<span> <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>

<p><strong>does not</strong> execute <code>ncol(mtcars) - 1</code> when creating the specification.
This can be seen in the output:</p>
<div class="sourceCode"><pre><code>
 &gt; rand_forest(mtry = ncol(mtcars) - 1)
 Random Forest Model Specification (unknown)

 Main Arguments:
   mtry = ncol(mtcars) - 1
</code></pre></div>

<p>The model functions save the argument <em>expressions</em> and their
associated environments (a.k.a. a quosure) to be evaluated later
when either <code><a href="fit.html">fit.model_spec()</a></code> or <code><a href="fit.html">fit_xy.model_spec()</a></code>  are
called with the actual data.</p>
<p>The consequence of this strategy is that any data required to
get the parameter values must be available when the model is
fit. The two main ways that this can fail is if:</p>
<ol><li><p>The data have been modified between the creation of the
model specification and when the model fit function is invoked.</p></li>
<li><p>If the model specification is saved and loaded into a new
session where those same data objects do not exist.</p></li>
</ol><p>The best way to avoid these issues is to not reference any data
objects in the global environment but to use data descriptors
such as <code><a href="descriptors.html">.cols()</a></code>. Another way of writing the previous
specification is</p>
<div class="sourceCode"><pre><code><span></span>
<span> <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu"><a href="../reference/descriptors.html">.cols</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>

<p>This is not dependent on any specific data object and
is evaluated immediately before the model fitting process begins.</p>
<p>One less advantageous approach to solving this issue is to use
quasiquotation. This would insert the actual R object into the
model specification and might be the best idea when the data
object is small. For example, using</p>
<div class="sourceCode"><pre><code><span></span>
<span> <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">mtcars</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>

<p>would work (and be reproducible between sessions) but embeds
the entire mtcars data set into the <code>mtry</code> expression:</p>
<div class="sourceCode"><pre><code>
 &gt; rand_forest(mtry = ncol(!!mtcars) - 1)
 Random Forest Model Specification (unknown)

 Main Arguments:
   mtry = ncol(structure(list(Sepal.Length = c(5.1, 4.9, 4.7, 4.6, 5, &lt;snip&gt;
</code></pre></div>

<p>However, if there were an object with the number of columns in
it, this wouldn't be too bad:</p>
<div class="sourceCode"><pre><code>
 &gt; mtry_val &lt;- ncol(mtcars) - 1
 &gt; mtry_val
 [1] 10
 &gt; rand_forest(mtry = !!mtry_val)
 Random Forest Model Specification (unknown)

 Main Arguments:
   mtry = 10
</code></pre></div>

<p>More information on quosures and quasiquotation can be found at
<a href="https://adv-r.hadley.nz/quasiquotation.html" class="external-link">https://adv-r.hadley.nz/quasiquotation.html</a>.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

