<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Tools to Register Models — set_new_model • parsnip</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tools to Register Models — set_new_model"><meta name="description" content="These functions are similar to constructors and can be used to validate
that there are no conflicts with the underlying model structures used by the
package."><meta property="og:description" content="These functions are similar to constructors and can be used to validate
that there are no conflicts with the underlying model structures used by the
package."><meta property="og:image" content="https://parsnip.tidymodels.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/parsnip.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/checklists.html">Dev checklists</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a></li>
    <li><a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more"><li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tools to Register Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/main/R/aaa_models.R" class="external-link"><code>R/aaa_models.R</code></a></small>
      <div class="d-none name"><code>set_new_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions are similar to constructors and can be used to validate
that there are no conflicts with the underlying model structures used by the
package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">set_new_model</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_model_mode</span><span class="op">(</span><span class="va">model</span>, <span class="va">mode</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_model_engine</span><span class="op">(</span><span class="va">model</span>, <span class="va">mode</span>, <span class="va">eng</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_model_arg</span><span class="op">(</span><span class="va">model</span>, <span class="va">eng</span>, <span class="va">parsnip</span>, <span class="va">original</span>, <span class="va">func</span>, <span class="va">has_submodel</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_dependency</span><span class="op">(</span><span class="va">model</span>, <span class="va">eng</span>, pkg <span class="op">=</span> <span class="st">"parsnip"</span>, mode <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_dependency</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_fit</span><span class="op">(</span><span class="va">model</span>, <span class="va">mode</span>, <span class="va">eng</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_fit</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_pred</span><span class="op">(</span><span class="va">model</span>, <span class="va">mode</span>, <span class="va">eng</span>, <span class="va">type</span>, <span class="va">value</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_pred_type</span><span class="op">(</span><span class="va">model</span>, <span class="va">type</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">show_model_info</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">pred_value_template</span><span class="op">(</span>pre <span class="op">=</span> <span class="cn">NULL</span>, post <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">func</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">set_encoding</span><span class="op">(</span><span class="va">model</span>, <span class="va">mode</span>, <span class="va">eng</span>, <span class="va">options</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">get_encoding</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A single character string for the model type (e.g.
<code>"rand_forest"</code>, etc).</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>A single character string for the model mode (e.g. "regression").</p></dd>


<dt id="arg-eng">eng<a class="anchor" aria-label="anchor" href="#arg-eng"></a></dt>
<dd><p>A single character string for the model engine.</p></dd>


<dt id="arg-parsnip">parsnip<a class="anchor" aria-label="anchor" href="#arg-parsnip"></a></dt>
<dd><p>A single character string for the "harmonized" argument name
that parsnip exposes.</p></dd>


<dt id="arg-original">original<a class="anchor" aria-label="anchor" href="#arg-original"></a></dt>
<dd><p>A single character string for the argument name that
underlying model function uses.</p></dd>


<dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>A named character vector that describes how to call
a function. <code>func</code> should have elements <code>pkg</code> and <code>fun</code>. The
former is optional but is recommended and the latter is
required. For example, <code>c(pkg = "stats", fun = "lm")</code> would be
used to invoke the usual linear regression function. In some
cases, it is helpful to use <code>c(fun = "predict")</code> when using a
package's <code>predict</code> method.</p></dd>


<dt id="arg-has-submodel">has_submodel<a class="anchor" aria-label="anchor" href="#arg-has-submodel"></a></dt>
<dd><p>A single logical for whether the argument
can make predictions on multiple submodels at once.</p></dd>


<dt id="arg-pkg">pkg<a class="anchor" aria-label="anchor" href="#arg-pkg"></a></dt>
<dd><p>An options character string for a package name.</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>A list that conforms to the <code>fit_obj</code> or <code>pred_obj</code> description
below, depending on context.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A single character value for the type of prediction. Possible
values are: <code>class</code>, <code>conf_int</code>, <code>numeric</code>, <code>pred_int</code>, <code>prob</code>, <code>quantile</code>,
and <code>raw</code>.</p></dd>


<dt id="arg-pre-post">pre, post<a class="anchor" aria-label="anchor" href="#arg-pre-post"></a></dt>
<dd><p>Optional functions for pre- and post-processing of prediction
results.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments that should be passed into the <code>args</code> slot for
prediction objects.</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>A list of options for engine-specific preprocessing encodings.
See Details below.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions are available for users to add their
own models or engines (in a package or otherwise) so that they can
be accessed using parsnip. This is more thoroughly documented
on the package web site (see references below).</p>
<p>In short, <code>parsnip</code> stores an environment object that contains
all of the information and code about how models are used (e.g.
fitting, predicting, etc). These functions can be used to add
models to that environment as well as helper functions that can
be used to makes sure that the model data is in the right
format.</p>
<p><code>check_model_exists()</code> checks the model value and ensures that the model has
already been registered. <code>check_model_doesnt_exist()</code> checks the model value
and also checks to see if it is novel in the environment.</p>
<p>The options for engine-specific encodings dictate how the predictors should be
handled. These options ensure that the data
that <code>parsnip</code> gives to the underlying model allows for a model fit that is
as similar as possible to what it would have produced directly.</p>
<p>For example, if <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit()</a></code> is used to fit a model that does not have
a formula interface, typically some predictor preprocessing must
be conducted. <code>glmnet</code> is a good example of this.</p>
<p>There are four options that can be used for the encodings:</p>
<p><code>predictor_indicators</code> describes whether and how to create indicator/dummy
variables from factor predictors. There are three options: <code>"none"</code> (do not
expand factor predictors), <code>"traditional"</code> (apply the standard
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> encodings), and <code>"one_hot"</code> (create the complete set
including the baseline level for all factors). This encoding only affects
cases when <code><a href="fit.html">fit.model_spec()</a></code> is used and the underlying model has an x/y
interface.</p>
<p>Another option is <code>compute_intercept</code>; this controls whether <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code>
should include the intercept in its formula. This affects more than the
inclusion of an intercept column. With an intercept, <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code>
computes dummy variables for all but one factor levels. Without an
intercept, <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> computes a full set of indicators for the
<em>first</em> factor variable, but an incomplete set for the remainder.</p>
<p>Next, the option <code>remove_intercept</code> will remove the intercept column
<em>after</em> <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> is finished. This can be useful if the model
function (e.g. <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>) automatically generates an intercept.</p>
<p>Finally, <code>allow_sparse_x</code> specifies whether the model function can natively
accommodate a sparse matrix representation for predictors during fitting
and tuning.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>"How to build a parsnip model"
<a href="https://www.tidymodels.org/learn/develop/models/" class="external-link">https://www.tidymodels.org/learn/develop/models/</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># set_new_model("shallow_learning_model")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show the information about a model:</span></span></span>
<span class="r-in"><span><span class="fu">show_model_info</span><span class="op">(</span><span class="st">"rand_forest"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information for `rand_forest`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  modes: unknown, classification, regression, censored regression </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  engines: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    classification: randomForest, ranger¹, spark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    regression:     randomForest, ranger¹, spark</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ¹The model can use case weights.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  arguments: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ranger:       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mtry  --&gt; mtry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       trees --&gt; num.trees</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       min_n --&gt; min.node.size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    randomForest: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mtry  --&gt; mtry</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       trees --&gt; ntree</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       min_n --&gt; nodesize</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    spark:        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       mtry  --&gt; feature_subset_strategy</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       trees --&gt; num_trees</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       min_n --&gt; min_instances_per_node</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  fit modules:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          engine           mode</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ranger classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          ranger     regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    randomForest classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    randomForest     regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           spark classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           spark     regression</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  prediction modules:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              mode       engine                    methods</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    classification randomForest           class, prob, raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    classification       ranger class, conf_int, prob, raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    classification        spark                class, prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        regression randomForest               numeric, raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        regression       ranger     conf_int, numeric, raw</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        regression        spark                    numeric</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

