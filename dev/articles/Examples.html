<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="This vignette  show how to **fit** and **predict** with different 
combinations of model, mode, and engine.
">
<title>Fitting and predicting with parsnip • parsnip</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting and predicting with parsnip">
<meta property="og:description" content="This vignette  show how to **fit** and **predict** with different 
combinations of model, mode, and engine.
">
<meta property="og:image" content="https://parsnip.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.0.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/parsnip.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a>
    <a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-learn-more">Learn more</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-learn-more">
    <a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a>
    <a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a>
    <a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting and predicting with parsnip</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/HEAD/vignettes/articles/Examples.Rmd" class="external-link"><code>vignettes/articles/Examples.Rmd</code></a></small>
      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<p>These examples show how to <em>fit</em> and <em>predict</em> with
different combinations of model, mode, and engine. As a reminder, in
parsnip,</p>
<ul>
<li><p>the <strong>model type</strong> differentiates basic modeling
approaches, such as random forests, logistic regression, linear support
vector machines, etc.,</p></li>
<li><p>the <strong>mode</strong> denotes in what kind of modeling
context it will be used (most commonly, classification or regression),
and</p></li>
<li><p>the computational <strong>engine</strong> indicates how the model
is fit, such as with a specific R package implementation or even methods
outside of R like Keras or Stan.</p></li>
</ul>
<p>The following examples use consistent data sets throughout. For
regression, we use the Chicago ridership data. For classification, we
use an artificial data set for a binary example and the Palmer penguins
data for a multiclass example.</p>
<div class="section level2">
<h2 id="bart-models">
<code>bart()</code> models<a class="anchor" aria-label="anchor" href="#bart-models"></a>
</h2>
<details id="bart-dbarts"><summary>
With the <code>"dbarts"</code> engine
</summary><h3>
Regression Example (<code>dbarts</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────── tidymodels 1.1.0.<span style="color: #BB0000;">9000</span> ──</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">broom       </span> 1.0.5          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rsample     </span> 1.1.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dials       </span> 1.2.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble      </span> 3.2.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr       </span> 1.1.2          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr       </span> 1.3.0     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">infer       </span> 1.0.4          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tune        </span> 1.1.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">modeldata   </span> 1.1.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflows   </span> 1.1.3     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">parsnip     </span> 1.1.0.<span style="color: #BB0000;">9003</span>     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflowsets</span> 1.0.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr       </span> 1.0.1          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">yardstick   </span> 1.2.0     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">recipes     </span> 1.0.6</span></span></code></pre>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ─────────────────────────────────── tidymodels_conflicts() ──</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">discard()</span> masks <span style="color: #0000BB;">scales</span>::discard()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>  masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>     masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">recipes</span>::<span style="color: #00BB00;">step()</span>  masks <span style="color: #0000BB;">stats</span>::step()</span></span>
<span>  <span class="co">## <span style="color: #0000BB;">•</span> Search for functions across packages at <span style="color: #00BB00;">https://www.tidymodels.org/find/</span></span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/bart.html">bart</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"dbarts"</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## BART Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: dbarts</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">bt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## `NULL`()</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.51</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.44</span></span></code></pre>
<h3>
Classification Example (<code>dbarts</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/bart.html">bart</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"dbarts"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## NULL</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## `NULL`()</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.352        0.648</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.823        0.177</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.497        0.503</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.509        0.491</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.434        0.566</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.185        0.815</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.663        0.337</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.392        0.608</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.967        0.033</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.095        0.905</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="boost_tree-models">
<code>boost_tree()</code> models<a class="anchor" aria-label="anchor" href="#boost_tree-models"></a>
</h2>
<details id="boost-tree-xgboost"><summary>
With the <code>"xgboost"</code> engine
</summary><h3>
Regression Example (<code>xgboost</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: xgboost</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">bt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ##### xgb.Booster</span></span>
<span>  <span class="co">## raw: 51.4 Kb </span></span>
<span>  <span class="co">## call:</span></span>
<span>  <span class="co">##   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span>  <span class="co">##     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span>  <span class="co">##     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span>  <span class="co">##     verbose = 0, nthread = 1, objective = "reg:squarederror")</span></span>
<span>  <span class="co">## params (as set within xgb.train):</span></span>
<span>  <span class="co">##   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "reg:squarederror", validate_parameters = "TRUE"</span></span>
<span>  <span class="co">## xgb.attributes:</span></span>
<span>  <span class="co">##   niter</span></span>
<span>  <span class="co">## callbacks:</span></span>
<span>  <span class="co">##   cb.evaluation.log()</span></span>
<span>  <span class="co">## # of features: 2 </span></span>
<span>  <span class="co">## niter: 15</span></span>
<span>  <span class="co">## nfeatures : 2 </span></span>
<span>  <span class="co">## evaluation_log:</span></span>
<span>  <span class="co">##     iter training_rmse</span></span>
<span>  <span class="co">##        1     10.481475</span></span>
<span>  <span class="co">##        2      7.620929</span></span>
<span>  <span class="co">## ---                   </span></span>
<span>  <span class="co">##       14      2.551943</span></span>
<span>  <span class="co">##       15      2.531085</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.26</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  5.92</span></span></code></pre>
<h3>
Classification Example (<code>xgboost</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: xgboost</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ##### xgb.Booster</span></span>
<span>  <span class="co">## raw: 40.8 Kb </span></span>
<span>  <span class="co">## call:</span></span>
<span>  <span class="co">##   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span>  <span class="co">##     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span>  <span class="co">##     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span>  <span class="co">##     verbose = 0, nthread = 1, objective = "binary:logistic")</span></span>
<span>  <span class="co">## params (as set within xgb.train):</span></span>
<span>  <span class="co">##   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "binary:logistic", validate_parameters = "TRUE"</span></span>
<span>  <span class="co">## xgb.attributes:</span></span>
<span>  <span class="co">##   niter</span></span>
<span>  <span class="co">## callbacks:</span></span>
<span>  <span class="co">##   cb.evaluation.log()</span></span>
<span>  <span class="co">## # of features: 2 </span></span>
<span>  <span class="co">## niter: 15</span></span>
<span>  <span class="co">## nfeatures : 2 </span></span>
<span>  <span class="co">## evaluation_log:</span></span>
<span>  <span class="co">##     iter training_logloss</span></span>
<span>  <span class="co">##        1        0.5524619</span></span>
<span>  <span class="co">##        2        0.4730697</span></span>
<span>  <span class="co">## ---                      </span></span>
<span>  <span class="co">##       14        0.2523133</span></span>
<span>  <span class="co">##       15        0.2490712</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.220        0.780 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.931        0.068<span style="text-decoration: underline;">9</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.638        0.362 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.815        0.185 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.292        0.708 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.120        0.880 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.796        0.204 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.392        0.608 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.879        0.121 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.038<span style="text-decoration: underline;">9</span>       0.961</span></span></code></pre>
</details><details id="boost-tree-C5.0"><summary>
With the <code>"C5.0"</code> engine
</summary><h3>
Classification Example (<code>C5.0</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"C5.0"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: C5.0</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## C5.0.default(x = x, y = y, trials = 15, control</span></span>
<span>  <span class="co">##  = C50::C5.0Control(minCases = 2, sample = 0))</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Classification Tree</span></span>
<span>  <span class="co">## Number of samples: 781 </span></span>
<span>  <span class="co">## Number of predictors: 2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of boosting iterations: 15 requested;  6 used due to early stopping</span></span>
<span>  <span class="co">## Average tree size: 3.2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Non-standard options: attempt to group attributes</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.311        0.689</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.863        0.137</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.535        0.465</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.336        0.664</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.336        0.664</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.137        0.863</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.496        0.504</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.311        0.689</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             1            0    </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0            1</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="decision_tree-models">
<code>decision_tree()</code> models<a class="anchor" aria-label="anchor" href="#decision_tree-models"></a>
</h2>
<details id="decision-tree-rpart"><summary>
With the <code>"rpart"</code> engine
</summary><h3>
Regression Example (<code>rpart</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>tree_depth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   tree_depth = 30</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: rpart</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">dt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## n= 5691 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## node), split, n, deviance, yval</span></span>
<span>  <span class="co">##       * denotes terminal node</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## 1) root 5691 244958.800 13.615560  </span></span>
<span>  <span class="co">##   2) Quincy_Wells&lt; 2.737 1721  22973.630  5.194394  </span></span>
<span>  <span class="co">##     4) Clark_Lake&lt; 5.07 1116  13166.830  4.260215 *</span></span>
<span>  <span class="co">##     5) Clark_Lake&gt;=5.07 605   7036.349  6.917607 *</span></span>
<span>  <span class="co">##   3) Quincy_Wells&gt;=2.737 3970  47031.540 17.266140  </span></span>
<span>  <span class="co">##     6) Clark_Lake&lt; 17.6965 1940  16042.090 15.418210 *</span></span>
<span>  <span class="co">##     7) Clark_Lake&gt;=17.6965 2030  18033.560 19.032140 *</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.92</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.92</span></span></code></pre>
<h3>
Classification Example (<code>rpart</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>tree_depth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   tree_depth = 30</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: rpart</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">dt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## n= 781 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## node), split, n, loss, yval, (yprob)</span></span>
<span>  <span class="co">##       * denotes terminal node</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##  1) root 781 348 Class1 (0.5544174 0.4455826)  </span></span>
<span>  <span class="co">##    2) B&lt; 1.495535 400  61 Class1 (0.8475000 0.1525000) *</span></span>
<span>  <span class="co">##    3) B&gt;=1.495535 381  94 Class2 (0.2467192 0.7532808)  </span></span>
<span>  <span class="co">##      6) B&lt; 2.079458 191  70 Class2 (0.3664921 0.6335079)  </span></span>
<span>  <span class="co">##       12) A&gt;=2.572663 48  13 Class1 (0.7291667 0.2708333) *</span></span>
<span>  <span class="co">##       13) A&lt; 2.572663 143  35 Class2 (0.2447552 0.7552448) *</span></span>
<span>  <span class="co">##      7) B&gt;=2.079458 190  24 Class2 (0.1263158 0.8736842) *</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.729        0.271</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.729        0.271</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.126        0.874</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.126        0.874</span></span></code></pre>
</details><details id="decision-tree-C5.0"><summary>
With the <code>"C5.0"</code> engine
</summary><h3>
Classification Example (<code>C5.0</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>min_n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"C5.0"</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   min_n = 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: C5.0</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">dt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## C5.0.default(x = x, y = y, trials = 1, control</span></span>
<span>  <span class="co">##  = C50::C5.0Control(minCases = 2, sample = 0))</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Classification Tree</span></span>
<span>  <span class="co">## Number of samples: 781 </span></span>
<span>  <span class="co">## Number of predictors: 2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Tree size: 4 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Non-standard options: attempt to group attributes</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.727        0.273</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.727        0.273</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.118        0.882</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.118        0.882</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="gen_additive_mod-models">
<code>gen_additive_mod()</code> models<a class="anchor" aria-label="anchor" href="#gen_additive_mod-models"></a>
</h2>
<details id="gen-additive-mod-mgcv"><summary>
With the <code>"mgcv"</code> engine
</summary><h3>
Regression Example (<code>mgcv</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">gam_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/gen_additive_mod.html">gen_additive_mod</a></span><span class="op">(</span>select_features <span class="op">=</span> <span class="cn">FALSE</span>, adjust_deg_free <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## GAM Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   select_features = FALSE</span></span>
<span>  <span class="co">##   adjust_deg_free = 10</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: mgcv</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_fit</span> <span class="op">&lt;-</span> <span class="va">gam_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">Clark_Lake</span> <span class="op">+</span> <span class="va">Quincy_Wells</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Family: gaussian </span></span>
<span>  <span class="co">## Link function: identity </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Formula:</span></span>
<span>  <span class="co">## ridership ~ Clark_Lake + Quincy_Wells</span></span>
<span>  <span class="co">## Total model degrees of freedom 3 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## GCV score: 9.505245</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
<h3>
Classification Example (<code>mgcv</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">gam_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/gen_additive_mod.html">gen_additive_mod</a></span><span class="op">(</span>select_features <span class="op">=</span> <span class="cn">FALSE</span>, adjust_deg_free <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## GAM Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   select_features = FALSE</span></span>
<span>  <span class="co">##   adjust_deg_free = 10</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: mgcv</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_fit</span> <span class="op">&lt;-</span> <span class="va">gam_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Family: binomial </span></span>
<span>  <span class="co">## Link function: logit </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Formula:</span></span>
<span>  <span class="co">## Class ~ A + B</span></span>
<span>  <span class="co">## Total model degrees of freedom 3 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## UBRE score: -0.07548008</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.091<span style="text-decoration: underline;">3</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.648      0.352  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.567      0.433  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">82</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="linear_reg-models">
<code>linear_reg()</code> models<a class="anchor" aria-label="anchor" href="#linear_reg-models"></a>
</h2>
<details id="linear-reg-lm"><summary>
With the <code>"lm"</code> engine
</summary><h3>
Regression Example (<code>lm</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: lm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## stats::lm(formula = ridership ~ ., data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">##  (Intercept)    Clark_Lake  Quincy_Wells  </span></span>
<span>  <span class="co">##       1.6624        0.7738        0.2557</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details><details id="linear-reg-glm"><summary>
With the <code>"glm"</code> engine
</summary><h3>
Regression Example (<code>glm</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  stats::glm(formula = ridership ~ ., family = stats::gaussian, </span></span>
<span>  <span class="co">##     data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">##  (Intercept)    Clark_Lake  Quincy_Wells  </span></span>
<span>  <span class="co">##       1.6624        0.7738        0.2557  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of Freedom: 5690 Total (i.e. Null);  5688 Residual</span></span>
<span>  <span class="co">## Null Deviance:     245000 </span></span>
<span>  <span class="co">## Residual Deviance: 53530   AIC: 28910</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details><details id="linear-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Regression Example (<code>glmnet</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "gaussian") </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##    Df  %Dev Lambda</span></span>
<span>  <span class="co">## 1   0  0.00 5.7970</span></span>
<span>  <span class="co">## 2   1 13.25 5.2820</span></span>
<span>  <span class="co">## 3   1 24.26 4.8130</span></span>
<span>  <span class="co">## 4   1 33.40 4.3850</span></span>
<span>  <span class="co">## 5   1 40.98 3.9960</span></span>
<span>  <span class="co">## 6   1 47.28 3.6410</span></span>
<span>  <span class="co">## 7   1 52.51 3.3170</span></span>
<span>  <span class="co">## 8   1 56.85 3.0220</span></span>
<span>  <span class="co">## 9   1 60.45 2.7540</span></span>
<span>  <span class="co">## 10  1 63.44 2.5090</span></span>
<span>  <span class="co">## 11  1 65.92 2.2860</span></span>
<span>  <span class="co">## 12  1 67.99 2.0830</span></span>
<span>  <span class="co">## 13  1 69.70 1.8980</span></span>
<span>  <span class="co">## 14  1 71.12 1.7300</span></span>
<span>  <span class="co">## 15  1 72.30 1.5760</span></span>
<span>  <span class="co">## 16  2 73.29 1.4360</span></span>
<span>  <span class="co">## 17  2 74.11 1.3080</span></span>
<span>  <span class="co">## 18  2 74.80 1.1920</span></span>
<span>  <span class="co">## 19  2 75.37 1.0860</span></span>
<span>  <span class="co">## 20  2 75.84 0.9897</span></span>
<span>  <span class="co">## 21  2 76.23 0.9018</span></span>
<span>  <span class="co">## 22  2 76.56 0.8217</span></span>
<span>  <span class="co">## 23  2 76.83 0.7487</span></span>
<span>  <span class="co">## 24  2 77.05 0.6822</span></span>
<span>  <span class="co">## 25  2 77.24 0.6216</span></span>
<span>  <span class="co">## 26  2 77.39 0.5664</span></span>
<span>  <span class="co">## 27  2 77.52 0.5160</span></span>
<span>  <span class="co">## 28  2 77.63 0.4702</span></span>
<span>  <span class="co">## 29  2 77.72 0.4284</span></span>
<span>  <span class="co">## 30  2 77.79 0.3904</span></span>
<span>  <span class="co">## 31  2 77.85 0.3557</span></span>
<span>  <span class="co">## 32  2 77.90 0.3241</span></span>
<span>  <span class="co">## 33  2 77.94 0.2953</span></span>
<span>  <span class="co">## 34  2 77.98 0.2691</span></span>
<span>  <span class="co">## 35  2 78.01 0.2452</span></span>
<span>  <span class="co">## 36  2 78.03 0.2234</span></span>
<span>  <span class="co">## 37  2 78.05 0.2035</span></span>
<span>  <span class="co">## 38  2 78.07 0.1855</span></span>
<span>  <span class="co">## 39  2 78.08 0.1690</span></span>
<span>  <span class="co">## 40  2 78.09 0.1540</span></span>
<span>  <span class="co">## 41  2 78.10 0.1403</span></span>
<span>  <span class="co">## 42  2 78.11 0.1278</span></span>
<span>  <span class="co">## 43  2 78.12 0.1165</span></span>
<span>  <span class="co">## 44  2 78.12 0.1061</span></span>
<span>  <span class="co">## 45  2 78.13 0.0967</span></span>
<span>  <span class="co">## 46  2 78.13 0.0881</span></span>
<span>  <span class="co">## 47  2 78.13 0.0803</span></span>
<span>  <span class="co">## 48  2 78.14 0.0732</span></span>
<span>  <span class="co">## 49  2 78.14 0.0666</span></span>
<span>  <span class="co">## 50  2 78.14 0.0607</span></span>
<span>  <span class="co">## 51  2 78.14 0.0553</span></span>
<span>  <span class="co">## 52  2 78.14 0.0504</span></span>
<span>  <span class="co">## 53  2 78.14 0.0459</span></span>
<span>  <span class="co">## 54  2 78.15 0.0419</span></span>
<span>  <span class="co">## 55  2 78.15 0.0381</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.57</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.15</span></span></code></pre>
</details><details id="linear-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Regression Example (<code>keras</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code>  ## Epoch 1/20
  ## 
  1/178 [..............................] - ETA: 53s - loss: 15.1766
 49/178 [=======&gt;......................] - ETA: 0s - loss: 10.7756 
 97/178 [===============&gt;..............] - ETA: 0s - loss: 10.5749
143/178 [=======================&gt;......] - ETA: 0s - loss: 10.5165
178/178 [==============================] - 0s 1ms/step - loss: 10.0167
  ## Epoch 2/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 6.9985
 49/178 [=======&gt;......................] - ETA: 0s - loss: 10.1544
 96/178 [===============&gt;..............] - ETA: 0s - loss: 9.5024 
145/178 [=======================&gt;......] - ETA: 0s - loss: 10.0557
178/178 [==============================] - 0s 1ms/step - loss: 9.9094
  ## Epoch 3/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 19.0196
 49/178 [=======&gt;......................] - ETA: 0s - loss: 9.2799 
 98/178 [===============&gt;..............] - ETA: 0s - loss: 9.2193
147/178 [=======================&gt;......] - ETA: 0s - loss: 9.9179
178/178 [==============================] - 0s 1ms/step - loss: 9.8368
  ## Epoch 4/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 17.7679
 49/178 [=======&gt;......................] - ETA: 0s - loss: 9.5708 
 92/178 [==============&gt;...............] - ETA: 0s - loss: 9.8530
140/178 [======================&gt;.......] - ETA: 0s - loss: 9.7508
178/178 [==============================] - 0s 1ms/step - loss: 9.7812
  ## Epoch 5/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 4.2688
 49/178 [=======&gt;......................] - ETA: 0s - loss: 9.5632
 97/178 [===============&gt;..............] - ETA: 0s - loss: 10.3469
145/178 [=======================&gt;......] - ETA: 0s - loss: 9.8263 
178/178 [==============================] - 0s 1ms/step - loss: 9.7383
  ## Epoch 6/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 8.5067
 49/178 [=======&gt;......................] - ETA: 0s - loss: 8.9405
 95/178 [===============&gt;..............] - ETA: 0s - loss: 9.1628
144/178 [=======================&gt;......] - ETA: 0s - loss: 9.7156
178/178 [==============================] - 0s 1ms/step - loss: 9.6945
  ## Epoch 7/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 9.4726
 46/178 [======&gt;.......................] - ETA: 0s - loss: 9.9031
 93/178 [==============&gt;...............] - ETA: 0s - loss: 9.6245
142/178 [======================&gt;.......] - ETA: 0s - loss: 10.1052
178/178 [==============================] - 0s 1ms/step - loss: 9.6628
  ## Epoch 8/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 13.9186
 50/178 [=======&gt;......................] - ETA: 0s - loss: 10.0832
 98/178 [===============&gt;..............] - ETA: 0s - loss: 9.9532 
146/178 [=======================&gt;......] - ETA: 0s - loss: 9.6536
178/178 [==============================] - 0s 1ms/step - loss: 9.6326
  ## Epoch 9/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 18.8077
 50/178 [=======&gt;......................] - ETA: 0s - loss: 10.5251
100/178 [===============&gt;..............] - ETA: 0s - loss: 10.1661
150/178 [========================&gt;.....] - ETA: 0s - loss: 9.7578 
178/178 [==============================] - 0s 1ms/step - loss: 9.6202
  ## Epoch 10/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 11.8274
 49/178 [=======&gt;......................] - ETA: 0s - loss: 9.8406 
100/178 [===============&gt;..............] - ETA: 0s - loss: 10.1639
148/178 [=======================&gt;......] - ETA: 0s - loss: 9.9188 
178/178 [==============================] - 0s 1ms/step - loss: 9.6056
  ## Epoch 11/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 7.3700
 48/178 [=======&gt;......................] - ETA: 0s - loss: 8.7491
 97/178 [===============&gt;..............] - ETA: 0s - loss: 9.0267
147/178 [=======================&gt;......] - ETA: 0s - loss: 9.7147
178/178 [==============================] - 0s 1ms/step - loss: 9.5867
  ## Epoch 12/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 17.8685
 50/178 [=======&gt;......................] - ETA: 0s - loss: 9.4923 
 99/178 [===============&gt;..............] - ETA: 0s - loss: 9.5799
148/178 [=======================&gt;......] - ETA: 0s - loss: 9.7975
178/178 [==============================] - 0s 1ms/step - loss: 9.5665
  ## Epoch 13/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 14.1629
 47/178 [======&gt;.......................] - ETA: 0s - loss: 10.8890
 95/178 [===============&gt;..............] - ETA: 0s - loss: 9.4819 
142/178 [======================&gt;.......] - ETA: 0s - loss: 9.5771
178/178 [==============================] - 0s 1ms/step - loss: 9.5650
  ## Epoch 14/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 4.7370
 49/178 [=======&gt;......................] - ETA: 0s - loss: 9.1341
 95/178 [===============&gt;..............] - ETA: 0s - loss: 9.5963
144/178 [=======================&gt;......] - ETA: 0s - loss: 9.8054
178/178 [==============================] - 0s 1ms/step - loss: 9.5549
  ## Epoch 15/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 13.6564
 48/178 [=======&gt;......................] - ETA: 0s - loss: 10.8603
 91/178 [==============&gt;...............] - ETA: 0s - loss: 10.2437
140/178 [======================&gt;.......] - ETA: 0s - loss: 9.5641 
178/178 [==============================] - 0s 1ms/step - loss: 9.5479
  ## Epoch 16/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 6.1265
 50/178 [=======&gt;......................] - ETA: 0s - loss: 9.9718
 96/178 [===============&gt;..............] - ETA: 0s - loss: 9.6439
143/178 [=======================&gt;......] - ETA: 0s - loss: 9.3685
178/178 [==============================] - 0s 1ms/step - loss: 9.5510
  ## Epoch 17/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 0.6493
 50/178 [=======&gt;......................] - ETA: 0s - loss: 9.0088
 99/178 [===============&gt;..............] - ETA: 0s - loss: 9.2521
148/178 [=======================&gt;......] - ETA: 0s - loss: 9.4270
178/178 [==============================] - 0s 1ms/step - loss: 9.5354
  ## Epoch 18/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 5.9864
 51/178 [=======&gt;......................] - ETA: 0s - loss: 9.7313
 98/178 [===============&gt;..............] - ETA: 0s - loss: 9.5003
147/178 [=======================&gt;......] - ETA: 0s - loss: 9.5186
178/178 [==============================] - 0s 1ms/step - loss: 9.5303
  ## Epoch 19/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 1.6641
 49/178 [=======&gt;......................] - ETA: 0s - loss: 8.8752
 93/178 [==============&gt;...............] - ETA: 0s - loss: 9.0043
140/178 [======================&gt;.......] - ETA: 0s - loss: 9.1579
178/178 [==============================] - 0s 1ms/step - loss: 9.5235
  ## Epoch 20/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 13.3896
 50/178 [=======&gt;......................] - ETA: 0s - loss: 11.7371
 98/178 [===============&gt;..............] - ETA: 0s - loss: 10.2787
144/178 [=======================&gt;......] - ETA: 0s - loss: 9.6260 
178/178 [==============================] - 0s 1ms/step - loss: 9.5202</code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense (Dense)                   (None, 1)                    3           </span></span>
<span>  <span class="co">##  dense_1 (Dense)                 (None, 1)                    2           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 5</span></span>
<span>  <span class="co">## Trainable params: 5</span></span>
<span>  <span class="co">## Non-trainable params: 0</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.48</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.12</span></span></code></pre>
</details><details id="linear-reg-stan"><summary>
With the <code>"stan"</code> engine
</summary><h3>
Regression Example (<code>stan</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb105"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"stan"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: stan</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## stan_glm</span></span>
<span>  <span class="co">##  family:       gaussian [identity]</span></span>
<span>  <span class="co">##  formula:      ridership ~ .</span></span>
<span>  <span class="co">##  observations: 5691</span></span>
<span>  <span class="co">##  predictors:   3</span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">##              Median MAD_SD</span></span>
<span>  <span class="co">## (Intercept)  1.7    0.1   </span></span>
<span>  <span class="co">## Clark_Lake   0.8    0.0   </span></span>
<span>  <span class="co">## Quincy_Wells 0.3    0.1   </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Auxiliary parameter(s):</span></span>
<span>  <span class="co">##       Median MAD_SD</span></span>
<span>  <span class="co">## sigma 3.1    0.0   </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">## * For help interpreting the printed output see ?print.stanreg</span></span>
<span>  <span class="co">## * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="logistic_reg-models">
<code>logistic_reg()</code> models<a class="anchor" aria-label="anchor" href="#logistic_reg-models"></a>
</h2>
<details id="logistic-reg-glm"><summary>
With the <code>"glm"</code> engine
</summary><h3>
Classification Example (<code>glm</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb112"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb115"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  stats::glm(formula = Class ~ ., family = stats::binomial, data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">## (Intercept)            A            B  </span></span>
<span>  <span class="co">##      -3.755       -1.259        3.855  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of Freedom: 780 Total (i.e. Null);  778 Residual</span></span>
<span>  <span class="co">## Null Deviance:     1073 </span></span>
<span>  <span class="co">## Residual Deviance: 662.1   AIC: 668.1</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.091<span style="text-decoration: underline;">3</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.648      0.352  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.567      0.433  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">82</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details><details id="logistic-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Classification Example (<code>glmnet</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb120"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb122"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "binomial") </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##    Df  %Dev   Lambda</span></span>
<span>  <span class="co">## 1   0  0.00 0.308500</span></span>
<span>  <span class="co">## 2   1  4.76 0.281100</span></span>
<span>  <span class="co">## 3   1  8.75 0.256100</span></span>
<span>  <span class="co">## 4   1 12.13 0.233300</span></span>
<span>  <span class="co">## 5   1 15.01 0.212600</span></span>
<span>  <span class="co">## 6   1 17.50 0.193700</span></span>
<span>  <span class="co">## 7   1 19.64 0.176500</span></span>
<span>  <span class="co">## 8   1 21.49 0.160800</span></span>
<span>  <span class="co">## 9   1 23.10 0.146500</span></span>
<span>  <span class="co">## 10  1 24.49 0.133500</span></span>
<span>  <span class="co">## 11  1 25.71 0.121700</span></span>
<span>  <span class="co">## 12  1 26.76 0.110900</span></span>
<span>  <span class="co">## 13  1 27.67 0.101000</span></span>
<span>  <span class="co">## 14  1 28.46 0.092030</span></span>
<span>  <span class="co">## 15  1 29.15 0.083860</span></span>
<span>  <span class="co">## 16  1 29.74 0.076410</span></span>
<span>  <span class="co">## 17  1 30.25 0.069620</span></span>
<span>  <span class="co">## 18  1 30.70 0.063430</span></span>
<span>  <span class="co">## 19  1 31.08 0.057800</span></span>
<span>  <span class="co">## 20  1 31.40 0.052660</span></span>
<span>  <span class="co">## 21  1 31.68 0.047990</span></span>
<span>  <span class="co">## 22  1 31.92 0.043720</span></span>
<span>  <span class="co">## 23  1 32.13 0.039840</span></span>
<span>  <span class="co">## 24  2 32.70 0.036300</span></span>
<span>  <span class="co">## 25  2 33.50 0.033070</span></span>
<span>  <span class="co">## 26  2 34.18 0.030140</span></span>
<span>  <span class="co">## 27  2 34.78 0.027460</span></span>
<span>  <span class="co">## 28  2 35.29 0.025020</span></span>
<span>  <span class="co">## 29  2 35.72 0.022800</span></span>
<span>  <span class="co">## 30  2 36.11 0.020770</span></span>
<span>  <span class="co">## 31  2 36.43 0.018930</span></span>
<span>  <span class="co">## 32  2 36.71 0.017250</span></span>
<span>  <span class="co">## 33  2 36.96 0.015710</span></span>
<span>  <span class="co">## 34  2 37.16 0.014320</span></span>
<span>  <span class="co">## 35  2 37.34 0.013050</span></span>
<span>  <span class="co">## 36  2 37.49 0.011890</span></span>
<span>  <span class="co">## 37  2 37.62 0.010830</span></span>
<span>  <span class="co">## 38  2 37.73 0.009868</span></span>
<span>  <span class="co">## 39  2 37.82 0.008992</span></span>
<span>  <span class="co">## 40  2 37.90 0.008193</span></span>
<span>  <span class="co">## 41  2 37.97 0.007465</span></span>
<span>  <span class="co">## 42  2 38.02 0.006802</span></span>
<span>  <span class="co">## 43  2 38.07 0.006198</span></span>
<span>  <span class="co">## 44  2 38.11 0.005647</span></span>
<span>  <span class="co">## 45  2 38.15 0.005145</span></span>
<span>  <span class="co">## 46  2 38.18 0.004688</span></span>
<span>  <span class="co">## 47  2 38.20 0.004272</span></span>
<span>  <span class="co">## 48  2 38.22 0.003892</span></span>
<span>  <span class="co">## 49  2 38.24 0.003547</span></span>
<span>  <span class="co">## 50  2 38.25 0.003231</span></span>
<span>  <span class="co">## 51  2 38.26 0.002944</span></span>
<span>  <span class="co">## 52  2 38.27 0.002683</span></span>
<span>  <span class="co">## 53  2 38.28 0.002444</span></span>
<span>  <span class="co">## 54  2 38.29 0.002227</span></span>
<span>  <span class="co">## 55  2 38.29 0.002029</span></span>
<span>  <span class="co">## 56  2 38.30 0.001849</span></span>
<span>  <span class="co">## 57  2 38.30 0.001685</span></span>
<span>  <span class="co">## 58  2 38.31 0.001535</span></span>
<span>  <span class="co">## 59  2 38.31 0.001399</span></span>
<span>  <span class="co">## 60  2 38.31 0.001275</span></span>
<span>  <span class="co">## 61  2 38.31 0.001161</span></span>
<span>  <span class="co">## 62  2 38.32 0.001058</span></span>
<span>  <span class="co">## 63  2 38.32 0.000964</span></span>
<span>  <span class="co">## 64  2 38.32 0.000879</span></span>
<span>  <span class="co">## 65  2 38.32 0.000800</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb124"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.530        0.470</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.713        0.287</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.616        0.384</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.416        0.584</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.417        0.583</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.288        0.712</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.554        0.446</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.557        0.443</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.820        0.180</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.206        0.794</span></span></code></pre>
</details><details id="logistic-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Classification Example (<code>keras</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code>  ## Epoch 1/20
  ## 
 1/25 [&gt;.............................] - ETA: 8s - loss: 0.9281
25/25 [==============================] - 0s 1ms/step - loss: 0.8992
  ## Epoch 2/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8356
25/25 [==============================] - 0s 1ms/step - loss: 0.8881
  ## Epoch 3/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8668
25/25 [==============================] - 0s 1ms/step - loss: 0.8779
  ## Epoch 4/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.9564
25/25 [==============================] - 0s 1ms/step - loss: 0.8676
  ## Epoch 5/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8476
25/25 [==============================] - 0s 1ms/step - loss: 0.8574
  ## Epoch 6/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8917
25/25 [==============================] - 0s 1ms/step - loss: 0.8477
  ## Epoch 7/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8182
25/25 [==============================] - 0s 1ms/step - loss: 0.8377
  ## Epoch 8/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8252
25/25 [==============================] - 0s 1ms/step - loss: 0.8283
  ## Epoch 9/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7329
25/25 [==============================] - 0s 1ms/step - loss: 0.8187
  ## Epoch 10/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7995
25/25 [==============================] - 0s 1ms/step - loss: 0.8093
  ## Epoch 11/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8293
25/25 [==============================] - 0s 1ms/step - loss: 0.8004
  ## Epoch 12/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8200
25/25 [==============================] - 0s 1ms/step - loss: 0.7914
  ## Epoch 13/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.8006
25/25 [==============================] - 0s 1ms/step - loss: 0.7826
  ## Epoch 14/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6931
25/25 [==============================] - 0s 1ms/step - loss: 0.7742
  ## Epoch 15/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7503
25/25 [==============================] - 0s 1ms/step - loss: 0.7658
  ## Epoch 16/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6829
25/25 [==============================] - 0s 1ms/step - loss: 0.7578
  ## Epoch 17/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7192
25/25 [==============================] - 0s 1ms/step - loss: 0.7496
  ## Epoch 18/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7465
25/25 [==============================] - 0s 1ms/step - loss: 0.7417
  ## Epoch 19/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7213
25/25 [==============================] - 0s 1ms/step - loss: 0.7339
  ## Epoch 20/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7316
25/25 [==============================] - 0s 1ms/step - loss: 0.7265</code></pre>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_1"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_2 (Dense)                 (None, 1)                    3           </span></span>
<span>  <span class="co">##  dense_3 (Dense)                 (None, 2)                    4           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 7</span></span>
<span>  <span class="co">## Trainable params: 7</span></span>
<span>  <span class="co">## Non-trainable params: 0</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.516      0.484  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.842      0.158  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.526      0.474  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.837      0.163  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.648      0.352  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class1             0.546      0.454  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.745      0.255  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.531      0.469  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.990      0.009<span style="text-decoration: underline;">95</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class1             0.505      0.495</span></span></code></pre>
</details><details id="logistic-reg-LiblineaR"><summary>
With the <code>"LiblineaR"</code> engine
</summary><h3>
Classification Example (<code>LiblineaR</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized logistic regression primal (L2R_LR)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 0</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##             A         B     Bias</span></span>
<span>  <span class="co">## [1,] 1.219818 -3.759034 3.674861</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $ClassNames</span></span>
<span>  <span class="co">## [1] Class1 Class2</span></span>
<span>  <span class="co">## Levels: Class1 Class2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.096<span style="text-decoration: underline;">4</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.604      0.396  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.442      0.558  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.210      0.790  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.702      0.298  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.993      0.006<span style="text-decoration: underline;">67</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.112      0.888</span></span></code></pre>
</details><details id="logistic-reg-stan"><summary>
With the <code>"stan"</code> engine
</summary><h3>
Classification Example (<code>stan</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"stan"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: stan</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## stan_glm</span></span>
<span>  <span class="co">##  family:       binomial [logit]</span></span>
<span>  <span class="co">##  formula:      Class ~ .</span></span>
<span>  <span class="co">##  observations: 781</span></span>
<span>  <span class="co">##  predictors:   3</span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">##             Median MAD_SD</span></span>
<span>  <span class="co">## (Intercept) -3.8    0.3  </span></span>
<span>  <span class="co">## A           -1.3    0.2  </span></span>
<span>  <span class="co">## B            3.9    0.3  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">## * For help interpreting the printed output see ?print.stanreg</span></span>
<span>  <span class="co">## * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.090<span style="text-decoration: underline;">9</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.650      0.350  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.609      0.391  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.568      0.432  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">80</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="mars-models">
<code>mars()</code> models<a class="anchor" aria-label="anchor" href="#mars-models"></a>
</h2>
<details id="mars-earth"><summary>
With the <code>"earth"</code> engine
</summary><h3>
Regression Example (<code>earth</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mars.html">mars</a></span><span class="op">(</span>prod_degree <span class="op">=</span> <span class="fl">1</span>, prune_method <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"earth"</span><span class="op">)</span></span>
<span>  <span class="va">mars_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## MARS Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   prod_degree = 1</span></span>
<span>  <span class="co">##   prune_method = backward</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: earth</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mars_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mars_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Loading required package: Formula</span></span></code></pre>
<pre><code><span>  <span class="co">## Loading required package: plotmo</span></span></code></pre>
<pre><code><span>  <span class="co">## Loading required package: plotrix</span></span></code></pre>
<pre><code><span>  <span class="co">## </span></span>
<span>  <span class="co">## Attaching package: 'plotrix'</span></span></code></pre>
<pre><code><span>  <span class="co">## The following object is masked from 'package:scales':</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##     rescale</span></span></code></pre>
<pre><code><span>  <span class="co">## Loading required package: TeachingDemos</span></span></code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Selected 5 of 6 terms, and 2 of 2 predictors</span></span>
<span>  <span class="co">## Termination condition: RSq changed by less than 0.001 at 6 terms</span></span>
<span>  <span class="co">## Importance: Clark_Lake, Quincy_Wells</span></span>
<span>  <span class="co">## Number of terms at each degree of interaction: 1 4 (additive model)</span></span>
<span>  <span class="co">## GCV 9.085818    RSS 51543.98    GRSq 0.7889881    RSq 0.789581</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.99</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.68</span></span></code></pre>
<h3>
Classification Example (<code>earth</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mars.html">mars</a></span><span class="op">(</span>prod_degree <span class="op">=</span> <span class="fl">1</span>, prune_method <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"earth"</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## MARS Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   prod_degree = 1</span></span>
<span>  <span class="co">##   prune_method = backward</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: earth</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mars_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## GLM (family binomial, link logit):</span></span>
<span>  <span class="co">##  nulldev  df       dev  df   devratio     AIC iters converged</span></span>
<span>  <span class="co">##  1073.43 780   632.723 775      0.411   644.7     5         1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Earth selected 6 of 13 terms, and 2 of 2 predictors</span></span>
<span>  <span class="co">## Termination condition: Reached nk 21</span></span>
<span>  <span class="co">## Importance: B, A</span></span>
<span>  <span class="co">## Number of terms at each degree of interaction: 1 5 (additive model)</span></span>
<span>  <span class="co">## Earth GCV 0.1334948    RSS 101.3432    GRSq 0.461003    RSq 0.4747349</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.332       0.668  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.845       0.155  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.585       0.415  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.690       0.310  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.483       0.517  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.318       0.682  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.661       0.339  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.398       0.602  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.990       0.009<span style="text-decoration: underline;">72</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.062<span style="text-decoration: underline;">5</span>      0.938</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="mlp-models">
<code>mlp()</code> models<a class="anchor" aria-label="anchor" href="#mlp-models"></a>
</h2>
<details id="mlp-nnet"><summary>
With the <code>"nnet"</code> engine
</summary><h3>
Regression Example (<code>nnet</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 100</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## a 2-5-1 network with 21 weights</span></span>
<span>  <span class="co">## inputs: Clark_Lake Quincy_Wells </span></span>
<span>  <span class="co">## output(s): ridership </span></span>
<span>  <span class="co">## options were - linear output units</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  8.09</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.22</span></span></code></pre>
<h3>
Classification Example (<code>nnet</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 100</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## a 2-5-1 network with 21 weights</span></span>
<span>  <span class="co">## inputs: A B </span></span>
<span>  <span class="co">## output(s): Class </span></span>
<span>  <span class="co">## options were - entropy fitting</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.364        0.636</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.691        0.309</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.577        0.423</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.686        0.314</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.466        0.534</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.339        0.661</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.670        0.330</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.384        0.616</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.692        0.308</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.330        0.670</span></span></code></pre>
</details><details id="mlp-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Regression Example (<code>keras</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 20</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code>  ## Epoch 1/20
  ## 
  1/178 [..............................] - ETA: 44s - loss: 243.8779
 47/178 [======&gt;.......................] - ETA: 0s - loss: 212.9772 
 92/178 [==============&gt;...............] - ETA: 0s - loss: 210.7395
135/178 [=====================&gt;........] - ETA: 0s - loss: 210.0000
178/178 [==============================] - 0s 1ms/step - loss: 209.4788
  ## Epoch 2/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 208.5392
 48/178 [=======&gt;......................] - ETA: 0s - loss: 196.5281
 94/178 [==============&gt;...............] - ETA: 0s - loss: 194.3503
140/178 [======================&gt;.......] - ETA: 0s - loss: 192.7666
178/178 [==============================] - 0s 1ms/step - loss: 190.0570
  ## Epoch 3/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 161.3892
 47/178 [======&gt;.......................] - ETA: 0s - loss: 183.4099
 94/178 [==============&gt;...............] - ETA: 0s - loss: 182.9498
141/178 [======================&gt;.......] - ETA: 0s - loss: 180.9579
178/178 [==============================] - 0s 1ms/step - loss: 180.2281
  ## Epoch 4/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 150.7805
 46/178 [======&gt;.......................] - ETA: 0s - loss: 177.6863
 93/178 [==============&gt;...............] - ETA: 0s - loss: 174.6951
140/178 [======================&gt;.......] - ETA: 0s - loss: 173.7320
178/178 [==============================] - 0s 1ms/step - loss: 171.6500
  ## Epoch 5/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 181.9683
 48/178 [=======&gt;......................] - ETA: 0s - loss: 171.6433
 94/178 [==============&gt;...............] - ETA: 0s - loss: 167.5357
142/178 [======================&gt;.......] - ETA: 0s - loss: 164.9766
178/178 [==============================] - 0s 1ms/step - loss: 163.6920
  ## Epoch 6/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 180.0822
 48/178 [=======&gt;......................] - ETA: 0s - loss: 155.4071
 95/178 [===============&gt;..............] - ETA: 0s - loss: 155.9211
131/178 [=====================&gt;........] - ETA: 0s - loss: 156.8948
178/178 [==============================] - ETA: 0s - loss: 156.1884
178/178 [==============================] - 0s 1ms/step - loss: 156.1884
  ## Epoch 7/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 175.9635
 47/178 [======&gt;.......................] - ETA: 0s - loss: 150.8634
 94/178 [==============&gt;...............] - ETA: 0s - loss: 152.0584
141/178 [======================&gt;.......] - ETA: 0s - loss: 150.2977
178/178 [==============================] - 0s 1ms/step - loss: 149.0801
  ## Epoch 8/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 192.1491
 47/178 [======&gt;.......................] - ETA: 0s - loss: 143.0130
 94/178 [==============&gt;...............] - ETA: 0s - loss: 143.5952
140/178 [======================&gt;.......] - ETA: 0s - loss: 142.8358
178/178 [==============================] - 0s 1ms/step - loss: 142.3286
  ## Epoch 9/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 136.1792
 46/178 [======&gt;.......................] - ETA: 0s - loss: 141.0806
 92/178 [==============&gt;...............] - ETA: 0s - loss: 137.8438
139/178 [======================&gt;.......] - ETA: 0s - loss: 136.2944
178/178 [==============================] - 0s 1ms/step - loss: 135.9031
  ## Epoch 10/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 134.9698
 48/178 [=======&gt;......................] - ETA: 0s - loss: 133.8459
 95/178 [===============&gt;..............] - ETA: 0s - loss: 131.1702
141/178 [======================&gt;.......] - ETA: 0s - loss: 130.2012
178/178 [==============================] - 0s 1ms/step - loss: 129.7792
  ## Epoch 11/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 156.2684
 48/178 [=======&gt;......................] - ETA: 0s - loss: 128.9533
 94/178 [==============&gt;...............] - ETA: 0s - loss: 127.0378
140/178 [======================&gt;.......] - ETA: 0s - loss: 124.5188
178/178 [==============================] - 0s 1ms/step - loss: 123.9414
  ## Epoch 12/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 129.9755
 47/178 [======&gt;.......................] - ETA: 0s - loss: 123.0091
 93/178 [==============&gt;...............] - ETA: 0s - loss: 121.0549
139/178 [======================&gt;.......] - ETA: 0s - loss: 118.7069
178/178 [==============================] - 0s 1ms/step - loss: 118.3731
  ## Epoch 13/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 137.8051
 47/178 [======&gt;.......................] - ETA: 0s - loss: 114.3029
 93/178 [==============&gt;...............] - ETA: 0s - loss: 114.1591
139/178 [======================&gt;.......] - ETA: 0s - loss: 113.7724
178/178 [==============================] - 0s 1ms/step - loss: 113.0559
  ## Epoch 14/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 87.5172
 48/178 [=======&gt;......................] - ETA: 0s - loss: 110.0945
 93/178 [==============&gt;...............] - ETA: 0s - loss: 109.2541
139/178 [======================&gt;.......] - ETA: 0s - loss: 108.0399
178/178 [==============================] - 0s 1ms/step - loss: 107.9710
  ## Epoch 15/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 52.1648
 47/178 [======&gt;.......................] - ETA: 0s - loss: 104.8720
 93/178 [==============&gt;...............] - ETA: 0s - loss: 104.0719
139/178 [======================&gt;.......] - ETA: 0s - loss: 103.1386
178/178 [==============================] - 0s 1ms/step - loss: 103.0934
  ## Epoch 16/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 116.8698
 47/178 [======&gt;.......................] - ETA: 0s - loss: 99.6309 
 93/178 [==============&gt;...............] - ETA: 0s - loss: 100.4145
140/178 [======================&gt;.......] - ETA: 0s - loss: 99.5661 
178/178 [==============================] - 0s 1ms/step - loss: 98.3870
  ## Epoch 17/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 102.1168
 50/178 [=======&gt;......................] - ETA: 0s - loss: 95.2313 
 99/178 [===============&gt;..............] - ETA: 0s - loss: 93.3200
149/178 [========================&gt;.....] - ETA: 0s - loss: 94.2458
178/178 [==============================] - 0s 1ms/step - loss: 93.7979
  ## Epoch 18/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 81.5116
 47/178 [======&gt;.......................] - ETA: 0s - loss: 92.7600
 92/178 [==============&gt;...............] - ETA: 0s - loss: 90.9332
137/178 [======================&gt;.......] - ETA: 0s - loss: 90.1230
178/178 [==============================] - 0s 1ms/step - loss: 89.2906
  ## Epoch 19/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 100.2167
 46/178 [======&gt;.......................] - ETA: 0s - loss: 88.0820 
 91/178 [==============&gt;...............] - ETA: 0s - loss: 86.4254
137/178 [======================&gt;.......] - ETA: 0s - loss: 85.3512
178/178 [==============================] - 0s 1ms/step - loss: 84.9533
  ## Epoch 20/20
  ## 
  1/178 [..............................] - ETA: 0s - loss: 58.3560
 48/178 [=======&gt;......................] - ETA: 0s - loss: 81.5803
 95/178 [===============&gt;..............] - ETA: 0s - loss: 80.2230
142/178 [======================&gt;.......] - ETA: 0s - loss: 80.5044
178/178 [==============================] - 0s 1ms/step - loss: 80.7598</code></pre>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_2"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_4 (Dense)                 (None, 5)                    15          </span></span>
<span>  <span class="co">##  dense_5 (Dense)                 (None, 1)                    6           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 21</span></span>
<span>  <span class="co">## Trainable params: 21</span></span>
<span>  <span class="co">## Non-trainable params: 0</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  7.50</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  7.50</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  7.50</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  7.50</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  7.50</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.87</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.70</span></span></code></pre>
<h3>
Classification Example (<code>keras</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 20</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code>  ## Epoch 1/20
  ## 
 1/25 [&gt;.............................] - ETA: 7s - loss: 0.7053
25/25 [==============================] - 0s 1ms/step - loss: 0.6985
  ## Epoch 2/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.7013
25/25 [==============================] - 0s 1ms/step - loss: 0.6924
  ## Epoch 3/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6885
25/25 [==============================] - 0s 1ms/step - loss: 0.6867
  ## Epoch 4/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6879
25/25 [==============================] - 0s 1ms/step - loss: 0.6816
  ## Epoch 5/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6785
25/25 [==============================] - 0s 1ms/step - loss: 0.6766
  ## Epoch 6/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6798
25/25 [==============================] - 0s 1ms/step - loss: 0.6719
  ## Epoch 7/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6751
25/25 [==============================] - 0s 1ms/step - loss: 0.6675
  ## Epoch 8/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6629
25/25 [==============================] - 0s 1ms/step - loss: 0.6632
  ## Epoch 9/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6552
25/25 [==============================] - 0s 1ms/step - loss: 0.6589
  ## Epoch 10/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6577
25/25 [==============================] - 0s 1ms/step - loss: 0.6548
  ## Epoch 11/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6548
25/25 [==============================] - 0s 2ms/step - loss: 0.6506
  ## Epoch 12/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6472
25/25 [==============================] - 0s 1ms/step - loss: 0.6463
  ## Epoch 13/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6456
25/25 [==============================] - 0s 1ms/step - loss: 0.6420
  ## Epoch 14/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6324
25/25 [==============================] - 0s 1ms/step - loss: 0.6377
  ## Epoch 15/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6163
25/25 [==============================] - 0s 1ms/step - loss: 0.6335
  ## Epoch 16/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6253
25/25 [==============================] - 0s 1ms/step - loss: 0.6292
  ## Epoch 17/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.5982
25/25 [==============================] - 0s 1ms/step - loss: 0.6249
  ## Epoch 18/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6476
25/25 [==============================] - 0s 1ms/step - loss: 0.6206
  ## Epoch 19/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6534
25/25 [==============================] - 0s 1ms/step - loss: 0.6164
  ## Epoch 20/20
  ## 
 1/25 [&gt;.............................] - ETA: 0s - loss: 0.6284
25/25 [==============================] - 0s 1ms/step - loss: 0.6120</code></pre>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_3"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_6 (Dense)                 (None, 5)                    15          </span></span>
<span>  <span class="co">##  dense_7 (Dense)                 (None, 2)                    12          </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 27</span></span>
<span>  <span class="co">## Trainable params: 27</span></span>
<span>  <span class="co">## Non-trainable params: 0</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.541        0.459</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.667        0.333</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.599        0.401</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.479        0.521</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.477        0.523</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.412        0.588</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.556        0.444</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.558        0.442</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.749        0.251</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.375        0.625</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="multinom_reg-models">
<code>multinom_reg()</code> models<a class="anchor" aria-label="anchor" href="#multinom_reg-models"></a>
</h2>
<details id="multinom-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Classification Example (<code>glmnet</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "multinomial") </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Df  %Dev  Lambda</span></span>
<span><span class="co">## 1   0  0.00 0.31730</span></span>
<span><span class="co">## 2   1  3.43 0.28910</span></span>
<span><span class="co">## 3   1  6.30 0.26340</span></span>
<span><span class="co">## 4   1  8.74 0.24000</span></span>
<span><span class="co">## 5   1 10.83 0.21870</span></span>
<span><span class="co">## 6   1 12.62 0.19930</span></span>
<span><span class="co">## 7   1 14.17 0.18160</span></span>
<span><span class="co">## 8   1 15.51 0.16540</span></span>
<span><span class="co">## 9   1 16.67 0.15070</span></span>
<span><span class="co">## 10  1 17.68 0.13740</span></span>
<span><span class="co">## 11  1 18.56 0.12520</span></span>
<span><span class="co">## 12  2 19.93 0.11400</span></span>
<span><span class="co">## 13  2 21.31 0.10390</span></span>
<span><span class="co">## 14  2 22.50 0.09467</span></span>
<span><span class="co">## 15  2 23.52 0.08626</span></span>
<span><span class="co">## 16  2 24.40 0.07860</span></span>
<span><span class="co">## 17  2 25.16 0.07162</span></span>
<span><span class="co">## 18  2 25.81 0.06526</span></span>
<span><span class="co">## 19  2 26.37 0.05946</span></span>
<span><span class="co">## 20  2 26.86 0.05418</span></span>
<span><span class="co">## 21  2 27.27 0.04936</span></span>
<span><span class="co">## 22  2 27.63 0.04498</span></span>
<span><span class="co">## 23  2 27.94 0.04098</span></span>
<span><span class="co">## 24  2 28.21 0.03734</span></span>
<span><span class="co">## 25  2 28.44 0.03402</span></span>
<span><span class="co">## 26  2 28.63 0.03100</span></span>
<span><span class="co">## 27  2 28.80 0.02825</span></span>
<span><span class="co">## 28  2 28.94 0.02574</span></span>
<span><span class="co">## 29  2 29.06 0.02345</span></span>
<span><span class="co">## 30  2 29.17 0.02137</span></span>
<span><span class="co">## 31  2 29.26 0.01947</span></span>
<span><span class="co">## 32  2 29.33 0.01774</span></span>
<span><span class="co">## 33  2 29.39 0.01616</span></span>
<span><span class="co">## 34  2 29.45 0.01473</span></span>
<span><span class="co">## 35  2 29.49 0.01342</span></span>
<span><span class="co">## 36  2 29.53 0.01223</span></span>
<span><span class="co">## 37  2 29.56 0.01114</span></span>
<span><span class="co">## 38  2 29.59 0.01015</span></span>
<span><span class="co">## 39  2 29.61 0.00925</span></span>
<span><span class="co">## 40  2 29.63 0.00843</span></span>
<span><span class="co">## 41  2 29.65 0.00768</span></span>
<span><span class="co">## 42  2 29.67 0.00700</span></span>
<span><span class="co">## 43  2 29.68 0.00638</span></span>
<span><span class="co">## 44  2 29.69 0.00581</span></span>
<span><span class="co">## 45  2 29.70 0.00529</span></span>
<span><span class="co">## 46  2 29.71 0.00482</span></span>
<span><span class="co">## 47  2 29.71 0.00439</span></span>
<span><span class="co">## 48  2 29.72 0.00400</span></span>
<span><span class="co">## 49  2 29.72 0.00365</span></span>
<span><span class="co">## 50  2 29.73 0.00332</span></span>
<span><span class="co">## 51  2 29.73 0.00303</span></span>
<span><span class="co">## 52  2 29.74 0.00276</span></span>
<span><span class="co">## 53  2 29.74 0.00251</span></span>
<span><span class="co">## 54  2 29.74 0.00229</span></span>
<span><span class="co">## 55  2 29.75 0.00209</span></span>
<span><span class="co">## 56  2 29.75 0.00190</span></span>
<span><span class="co">## 57  2 29.75 0.00173</span></span>
<span><span class="co">## 58  2 29.75 0.00158</span></span>
<span><span class="co">## 59  2 29.75 0.00144</span></span>
<span><span class="co">## 60  2 29.75 0.00131</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Dream              0.339      0.448           0.214 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Biscoe             0.879      0.088<span style="text-decoration: underline;">2</span>          0.033<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Biscoe             0.539      0.317           0.144 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream              0.403      0.435           0.162 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Dream              0.297      0.481           0.221</span></span></code></pre>
</details><details id="multinom-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Classification Example (<code>keras</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Epoch 1/20
## 
1/11 [=&gt;............................] - ETA: 3s - loss: 3.9855
11/11 [==============================] - 0s 1ms/step - loss: 4.0373
## Epoch 2/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 4.2308
11/11 [==============================] - 0s 1ms/step - loss: 3.7940
## Epoch 3/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 3.6452
11/11 [==============================] - 0s 1ms/step - loss: 3.5608
## Epoch 4/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 3.0286
11/11 [==============================] - 0s 1ms/step - loss: 3.3381
## Epoch 5/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 3.6313
11/11 [==============================] - 0s 1ms/step - loss: 3.1355
## Epoch 6/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.8586
11/11 [==============================] - 0s 1ms/step - loss: 2.9402
## Epoch 7/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.5628
11/11 [==============================] - 0s 1ms/step - loss: 2.7618
## Epoch 8/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.4974
11/11 [==============================] - 0s 1ms/step - loss: 2.6052
## Epoch 9/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.0399
11/11 [==============================] - 0s 1ms/step - loss: 2.4556
## Epoch 10/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.2202
11/11 [==============================] - 0s 1ms/step - loss: 2.3275
## Epoch 11/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.2353
11/11 [==============================] - 0s 1ms/step - loss: 2.2145
## Epoch 12/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.4755
11/11 [==============================] - 0s 1ms/step - loss: 2.1133
## Epoch 13/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.5037
11/11 [==============================] - 0s 1ms/step - loss: 2.0276
## Epoch 14/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 2.4048
11/11 [==============================] - 0s 1ms/step - loss: 1.9525
## Epoch 15/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.5258
11/11 [==============================] - 0s 1ms/step - loss: 1.8899
## Epoch 16/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.5103
11/11 [==============================] - 0s 1ms/step - loss: 1.8379
## Epoch 17/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.6184
11/11 [==============================] - 0s 1ms/step - loss: 1.7915
## Epoch 18/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.6831
11/11 [==============================] - 0s 1ms/step - loss: 1.7516
## Epoch 19/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.6172
11/11 [==============================] - 0s 1ms/step - loss: 1.7164
## Epoch 20/20
## 
1/11 [=&gt;............................] - ETA: 0s - loss: 1.3602
11/11 [==============================] - 0s 1ms/step - loss: 1.6866</code></pre>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: "sequential_4"</span></span>
<span><span class="co">## __________________________________________________________________________</span></span>
<span><span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span><span class="co">## ==========================================================================</span></span>
<span><span class="co">##  dense_8 (Dense)                 (None, 1)                    3           </span></span>
<span><span class="co">##  dense_9 (Dense)                 (None, 3)                    6           </span></span>
<span><span class="co">## ==========================================================================</span></span>
<span><span class="co">## Total params: 9</span></span>
<span><span class="co">## Trainable params: 9</span></span>
<span><span class="co">## Non-trainable params: 0</span></span>
<span><span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Torgersen       0.283         0.017<span style="text-decoration: underline;">1</span>      0.700     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Dream           0.000<span style="text-decoration: underline;">116</span>      1.00        0.000<span style="text-decoration: underline;">002</span>03</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Dream           0.321         0.469       0.210     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream           0.050<span style="text-decoration: underline;">7</span>        0.938       0.011<span style="text-decoration: underline;">5</span>    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Torgersen       0.301         0.022<span style="text-decoration: underline;">9</span>      0.676</span></span></code></pre>
</details><details id="multinom-reg-nnet"><summary>
With the <code>"nnet"</code> engine
</summary><h3>
Classification Example (<code>nnet</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## nnet::multinom(formula = island ~ ., data = data, decay = ~0.1, </span></span>
<span><span class="co">##     trace = FALSE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##           (Intercept) bill_length_mm bill_depth_mm</span></span>
<span><span class="co">## Dream       -8.243575     -0.0580960     0.6168318</span></span>
<span><span class="co">## Torgersen   -1.610588     -0.2789588     0.6978480</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual Deviance: 502.5009 </span></span>
<span><span class="co">## AIC: 514.5009</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Dream              0.193      0.450          0.357  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Biscoe             0.937      0.058<span style="text-decoration: underline;">2</span>         0.004<span style="text-decoration: underline;">87</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Biscoe             0.462      0.364          0.174  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream              0.450      0.495          0.055<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Dream              0.183      0.506          0.311</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="nearest_neighbor-models">
<code>nearest_neighbor()</code> models<a class="anchor" aria-label="anchor" href="#nearest_neighbor-models"></a>
</h2>
<details id="nearest-neighbor-kknn"><summary>
With the <code>"kknn"</code> engine
</summary><h3>
Regression Example (<code>kknn</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span><span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_reg_spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/nearest_neighbor.html">nearest_neighbor</a></span><span class="op">(</span>neighbors <span class="op">=</span> <span class="fl">5</span>, weight_func <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kknn"</span><span class="op">)</span></span>
<span><span class="va">knn_reg_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## K-Nearest Neighbor Model Specification (regression)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   neighbors = 5</span></span>
<span><span class="co">##   weight_func = triangular</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kknn</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_reg_fit</span> <span class="op">&lt;-</span> <span class="va">knn_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span><span class="va">knn_reg_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## kknn::train.kknn(formula = ridership ~ ., data = data, ks = min_rows(5,     data, 5), kernel = ~"triangular")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of response variable: continuous</span></span>
<span><span class="co">## minimal mean absolute error: 1.79223</span></span>
<span><span class="co">## Minimal mean squared error: 11.21809</span></span>
<span><span class="co">## Best kernel: triangular</span></span>
<span><span class="co">## Best k: 5</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span><span class="co">##   .pred</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 20.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 21.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 21.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 21.8 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 19.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  7.83</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>  5.54</span></span></code></pre>
<h3>
Classification Example (<code>kknn</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>Since there are two classes, we’ll use an odd number of neighbors to
avoid ties:</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_cls_spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/nearest_neighbor.html">nearest_neighbor</a></span><span class="op">(</span>neighbors <span class="op">=</span> <span class="fl">11</span>, weight_func <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kknn"</span><span class="op">)</span></span>
<span><span class="va">knn_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## K-Nearest Neighbor Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   neighbors = 11</span></span>
<span><span class="co">##   weight_func = triangular</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kknn</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_cls_fit</span> <span class="op">&lt;-</span> <span class="va">knn_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span><span class="va">knn_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## kknn::train.kknn(formula = Class ~ ., data = data, ks = min_rows(11,     data, 5), kernel = ~"triangular")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of response variable: nominal</span></span>
<span><span class="co">## Minimal misclassification: 0.1869398</span></span>
<span><span class="co">## Best kernel: triangular</span></span>
<span><span class="co">## Best k: 11</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.177       0.823  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.995       0.005<span style="text-decoration: underline;">15</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.590       0.410  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.770       0.230  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.333       0.667  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.182       0.818  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.692       0.308  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.400       0.600  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.814       0.186  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.027<span style="text-decoration: underline;">3</span>      0.973</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="rand_forest-models">
<code>rand_forest()</code> models<a class="anchor" aria-label="anchor" href="#rand_forest-models"></a>
</h2>
<details id="rand-forest-ranger"><summary>
With the <code>"ranger"</code> engine
</summary><h3>
Regression Example (<code>ranger</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: ranger</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span> <span class="op">&lt;-</span> <span class="va">rf_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Ranger result</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  ranger::ranger(x = maybe_data_frame(x), y = y, num.trees = ~200,      min.node.size = min_rows(~5, x), num.threads = 1, verbose = FALSE,      seed = sample.int(10^5, 1)) </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Type:                             Regression </span></span>
<span>  <span class="co">## Number of trees:                  200 </span></span>
<span>  <span class="co">## Sample size:                      5691 </span></span>
<span>  <span class="co">## Number of independent variables:  2 </span></span>
<span>  <span class="co">## Mtry:                             1 </span></span>
<span>  <span class="co">## Target node size:                 5 </span></span>
<span>  <span class="co">## Variable importance mode:         none </span></span>
<span>  <span class="co">## Splitrule:                        variance </span></span>
<span>  <span class="co">## OOB prediction error (MSE):       9.72953 </span></span>
<span>  <span class="co">## R squared (OOB):                  0.7739986</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.32</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.03</span></span></code></pre>
<h3>
Classification Example (<code>ranger</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: ranger</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span> <span class="op">&lt;-</span> <span class="va">rf_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Ranger result</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  ranger::ranger(x = maybe_data_frame(x), y = y, num.trees = ~200,      min.node.size = min_rows(~5, x), num.threads = 1, verbose = FALSE,      seed = sample.int(10^5, 1), probability = TRUE) </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Type:                             Probability estimation </span></span>
<span>  <span class="co">## Number of trees:                  200 </span></span>
<span>  <span class="co">## Sample size:                      781 </span></span>
<span>  <span class="co">## Number of independent variables:  2 </span></span>
<span>  <span class="co">## Mtry:                             1 </span></span>
<span>  <span class="co">## Target node size:                 5 </span></span>
<span>  <span class="co">## Variable importance mode:         none </span></span>
<span>  <span class="co">## Splitrule:                        gini </span></span>
<span>  <span class="co">## OOB prediction error (Brier s.):  0.1534794</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2           0.274         0.725 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1           0.928         0.071<span style="text-decoration: underline;">6</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class2           0.497         0.503 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1           0.703         0.297 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2           0.302         0.698 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2           0.151         0.849 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1           0.701         0.299 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1           0.592         0.409 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1           0.752         0.248 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2           0.002<span style="text-decoration: underline;">25</span>       0.998</span></span></code></pre>
</details><details id="rand-forest-randomForest"><summary>
With the <code>"randomForest"</code> engine
</summary><h3>
Regression Example (<code>randomForest</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: randomForest</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span> <span class="op">&lt;-</span> <span class="va">rf_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  randomForest(x = maybe_data_frame(x), y = y, ntree = ~200, nodesize = min_rows(~5,      x)) </span></span>
<span>  <span class="co">##                Type of random forest: regression</span></span>
<span>  <span class="co">##                      Number of trees: 200</span></span>
<span>  <span class="co">## No. of variables tried at each split: 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##           Mean of squared residuals: 9.696736</span></span>
<span>  <span class="co">##                     % Var explained: 77.47</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.9 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.33</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.16</span></span></code></pre>
<h3>
Classification Example (<code>randomForest</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: randomForest</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span> <span class="op">&lt;-</span> <span class="va">rf_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  randomForest(x = maybe_data_frame(x), y = y, ntree = ~200, nodesize = min_rows(~5,      x)) </span></span>
<span>  <span class="co">##                Type of random forest: classification</span></span>
<span>  <span class="co">##                      Number of trees: 200</span></span>
<span>  <span class="co">## No. of variables tried at each split: 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##         OOB estimate of  error rate: 19.72%</span></span>
<span>  <span class="co">## Confusion matrix:</span></span>
<span>  <span class="co">##        Class1 Class2 class.error</span></span>
<span>  <span class="co">## Class1    363     70   0.1616628</span></span>
<span>  <span class="co">## Class2     84    264   0.2413793</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.23         0.77 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.95         0.05 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.59         0.41 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.75         0.25 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.305        0.695</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.105        0.895</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.685        0.315</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.63         0.37 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.79         0.21 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.02         0.98</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_linear-models">
<code>svm_linear()</code> models<a class="anchor" aria-label="anchor" href="#svm_linear-models"></a>
</h2>
<details id="svm-linear-LiblineaR"><summary>
With the <code>"LiblineaR"</code> engine
</summary><h3>
Regression Example (<code>LiblineaR</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized L2-loss support vector regression primal (L2R_L2LOSS_SVR)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 11</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##      Clark_Lake Quincy_Wells       Bias</span></span>
<span>  <span class="co">## [1,]  0.8277352    0.3430336 0.05042585</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.9 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.40</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  5.90</span></span></code></pre>
<h3>
Classification Example (<code>LiblineaR</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized L2-loss support vector classification dual (L2R_L2LOSS_SVC_DUAL)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##              A         B     Bias</span></span>
<span>  <span class="co">## [1,] 0.4067922 -1.314783 1.321851</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $ClassNames</span></span>
<span>  <span class="co">## [1] Class1 Class2</span></span>
<span>  <span class="co">## Levels: Class1 Class2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted for hard class predictions.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 1</span></span></span>
<span>  <span class="co">##    .pred_class</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2</span></span></code></pre>
</details><details id="svm-linear-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: eps-svr  (regression) </span></span>
<span>  <span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Linear (vanilla) kernel function. </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 2283 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -825.1632 </span></span>
<span>  <span class="co">## Training error : 0.226456</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.87</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.41</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb291"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb293"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: C-svc  (classification) </span></span>
<span>  <span class="co">##  parameter : cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Linear (vanilla) kernel function. </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 353 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -349.425 </span></span>
<span>  <span class="co">## Training error : 0.174136 </span></span>
<span>  <span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.095<span style="text-decoration: underline;">6</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.445      0.555  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.212      0.788  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.704      0.296  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.006<span style="text-decoration: underline;">46</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.114      0.886</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_poly-models">
<code>svm_poly()</code> models<a class="anchor" aria-label="anchor" href="#svm_poly-models"></a>
</h2>
<details id="svm-poly-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_poly.html">svm_poly</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Polynomial Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: eps-svr  (regression) </span></span>
<span>  <span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Polynomial kernel function. </span></span>
<span>  <span class="co">##  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 2283 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -825.1628 </span></span>
<span>  <span class="co">## Training error : 0.226471</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.87</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.41</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb309"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_poly.html">svm_poly</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Polynomial Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: C-svc  (classification) </span></span>
<span>  <span class="co">##  parameter : cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Polynomial kernel function. </span></span>
<span>  <span class="co">##  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 353 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -349.425 </span></span>
<span>  <span class="co">## Training error : 0.174136 </span></span>
<span>  <span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.095<span style="text-decoration: underline;">6</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.445      0.555  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.212      0.788  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.704      0.296  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.006<span style="text-decoration: underline;">46</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.114      0.886</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_rbf-models">
<code>svm_rbf()</code> models<a class="anchor" aria-label="anchor" href="#svm_rbf-models"></a>
</h2>
<details id="svm-rbf-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span><span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/svm_rbf.html">svm_rbf</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span><span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Radial Basis Function Support Vector Machine Model Specification (regression)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   cost = 1</span></span>
<span><span class="co">##   margin = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span><span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SV type: eps-svr  (regression) </span></span>
<span><span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Gaussian Radial Basis kernel function. </span></span>
<span><span class="co">##  Hyperparameter : sigma =  10.8262370251485 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors : 2233 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Objective Function Value : -746.584 </span></span>
<span><span class="co">## Training error : 0.205567</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span><span class="co">##   .pred</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 20.7 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 21.3 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 21.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  6.77</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>  6.13</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/svm_rbf.html">svm_rbf</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span><span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Radial Basis Function Support Vector Machine Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   cost = 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span><span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SV type: C-svc  (classification) </span></span>
<span><span class="co">##  parameter : cost C = 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Gaussian Radial Basis kernel function. </span></span>
<span><span class="co">##  Hyperparameter : sigma =  1.63216688499952 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors : 327 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Objective Function Value : -294.4344 </span></span>
<span><span class="co">## Training error : 0.169014 </span></span>
<span><span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.238       0.762 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.905       0.095<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.619       0.381 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.879       0.121 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.641       0.359 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.153       0.847 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.745       0.255 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.313       0.687 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.878       0.122 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.137       0.863</span></span></code></pre>
</details>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

  </div></footer>
</body>
</html>
