<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting and predicting with parsnip • parsnip</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting and predicting with parsnip">
<meta name="description" content="This vignette  show how to **fit** and **predict** with different
combinations of model, mode, and engine.
">
<meta property="og:description" content="This vignette  show how to **fit** and **predict** with different
combinations of model, mode, and engine.
">
<meta property="og:image" content="https://parsnip.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.1.9004</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/parsnip.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a></li>
    <li><a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting and predicting with parsnip</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/main/vignettes/articles/Examples.Rmd" class="external-link"><code>vignettes/articles/Examples.Rmd</code></a></small>
      <div class="d-none name"><code>Examples.Rmd</code></div>
    </div>

    
    
<p>These examples show how to <em>fit</em> and <em>predict</em> with
different combinations of model, mode, and engine. As a reminder, in
parsnip,</p>
<ul>
<li><p>the <strong>model type</strong> differentiates basic modeling
approaches, such as random forests, logistic regression, linear support
vector machines, etc.,</p></li>
<li><p>the <strong>mode</strong> denotes in what kind of modeling
context it will be used (most commonly, classification or regression),
and</p></li>
<li><p>the computational <strong>engine</strong> indicates how the model
is fit, such as with a specific R package implementation or even methods
outside of R like Keras or Stan.</p></li>
</ul>
<p>The following examples use consistent data sets throughout. For
regression, we use the Chicago ridership data. For classification, we
use an artificial data set for a binary example and the Palmer penguins
data for a multiclass example.</p>
<div class="section level2">
<h2 id="bart-models">
<code>bart()</code> models<a class="anchor" aria-label="anchor" href="#bart-models"></a>
</h2>
<details id="bart-dbarts"><summary>
With the <code>"dbarts"</code> engine
</summary><h3>
Regression Example (<code>dbarts</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────── tidymodels 1.2.0.<span style="color: #BB0000;">9000</span> ──</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">broom       </span> 1.0.7          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rsample     </span> 1.2.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dials       </span> 1.3.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble      </span> 3.2.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr       </span> 1.1.4          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr       </span> 1.3.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">infer       </span> 1.0.7          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tune        </span> 1.2.1     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">modeldata   </span> 1.4.0          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflows   </span> 1.1.4     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">parsnip     </span> 1.2.1.<span style="color: #BB0000;">9004</span>     <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflowsets</span> 1.1.0     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr       </span> 1.0.2          <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">yardstick   </span> 1.3.2     </span></span>
<span>  <span class="co">## <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">recipes     </span> 1.1.0</span></span></code></pre>
<pre><code><span>  <span class="co">## ── <span style="font-weight: bold;">Conflicts</span> ─────────────────────────────────── tidymodels_conflicts() ──</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">discard()</span> masks <span style="color: #0000BB;">scales</span>::discard()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>  masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>     masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span>  <span class="co">## <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">recipes</span>::<span style="color: #00BB00;">step()</span>  masks <span style="color: #0000BB;">stats</span>::step()</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/bart.html">bart</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"dbarts"</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## BART Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: dbarts</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">bt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## `NULL`()</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.51</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.44</span></span></code></pre>
<h3>
Classification Example (<code>dbarts</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/bart.html">bart</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"dbarts"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## NULL</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## `NULL`()</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.352        0.648</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.823        0.177</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.497        0.503</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.509        0.491</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.434        0.566</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.185        0.815</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.663        0.337</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.392        0.608</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.967        0.033</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.095        0.905</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="boost_tree-models">
<code>boost_tree()</code> models<a class="anchor" aria-label="anchor" href="#boost_tree-models"></a>
</h2>
<details id="boost-tree-xgboost"><summary>
With the <code>"xgboost"</code> engine
</summary><h3>
Regression Example (<code>xgboost</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: xgboost</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">bt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ##### xgb.Booster</span></span>
<span>  <span class="co">## raw: 51.4 Kb </span></span>
<span>  <span class="co">## call:</span></span>
<span>  <span class="co">##   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span>  <span class="co">##     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span>  <span class="co">##     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span>  <span class="co">##     verbose = 0, nthread = 1, objective = "reg:squarederror")</span></span>
<span>  <span class="co">## params (as set within xgb.train):</span></span>
<span>  <span class="co">##   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "reg:squarederror", validate_parameters = "TRUE"</span></span>
<span>  <span class="co">## xgb.attributes:</span></span>
<span>  <span class="co">##   niter</span></span>
<span>  <span class="co">## callbacks:</span></span>
<span>  <span class="co">##   cb.evaluation.log()</span></span>
<span>  <span class="co">## # of features: 2 </span></span>
<span>  <span class="co">## niter: 15</span></span>
<span>  <span class="co">## nfeatures : 2 </span></span>
<span>  <span class="co">## evaluation_log:</span></span>
<span>  <span class="co">##   iter training_rmse</span></span>
<span>  <span class="co">##  &lt;num&gt;         &lt;num&gt;</span></span>
<span>  <span class="co">##      1     10.481475</span></span>
<span>  <span class="co">##      2      7.620929</span></span>
<span>  <span class="co">##    ---           ---</span></span>
<span>  <span class="co">##     14      2.551943</span></span>
<span>  <span class="co">##     15      2.531085</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.26</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  5.92</span></span></code></pre>
<h3>
Classification Example (<code>xgboost</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"xgboost"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: xgboost</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ##### xgb.Booster</span></span>
<span>  <span class="co">## raw: 40.8 Kb </span></span>
<span>  <span class="co">## call:</span></span>
<span>  <span class="co">##   xgboost::xgb.train(params = list(eta = 0.3, max_depth = 6, gamma = 0, </span></span>
<span>  <span class="co">##     colsample_bytree = 1, colsample_bynode = 1, min_child_weight = 1, </span></span>
<span>  <span class="co">##     subsample = 1), data = x$data, nrounds = 15, watchlist = x$watchlist, </span></span>
<span>  <span class="co">##     verbose = 0, nthread = 1, objective = "binary:logistic")</span></span>
<span>  <span class="co">## params (as set within xgb.train):</span></span>
<span>  <span class="co">##   eta = "0.3", max_depth = "6", gamma = "0", colsample_bytree = "1", colsample_bynode = "1", min_child_weight = "1", subsample = "1", nthread = "1", objective = "binary:logistic", validate_parameters = "TRUE"</span></span>
<span>  <span class="co">## xgb.attributes:</span></span>
<span>  <span class="co">##   niter</span></span>
<span>  <span class="co">## callbacks:</span></span>
<span>  <span class="co">##   cb.evaluation.log()</span></span>
<span>  <span class="co">## # of features: 2 </span></span>
<span>  <span class="co">## niter: 15</span></span>
<span>  <span class="co">## nfeatures : 2 </span></span>
<span>  <span class="co">## evaluation_log:</span></span>
<span>  <span class="co">##   iter training_logloss</span></span>
<span>  <span class="co">##  &lt;num&gt;            &lt;num&gt;</span></span>
<span>  <span class="co">##      1        0.5524619</span></span>
<span>  <span class="co">##      2        0.4730697</span></span>
<span>  <span class="co">##    ---              ---</span></span>
<span>  <span class="co">##     14        0.2523133</span></span>
<span>  <span class="co">##     15        0.2490712</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.220        0.780 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.931        0.068<span style="text-decoration: underline;">9</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.638        0.362 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.815        0.185 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.292        0.708 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.120        0.880 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.796        0.204 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.392        0.608 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.879        0.121 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.038<span style="text-decoration: underline;">9</span>       0.961</span></span></code></pre>
</details><details id="boost-tree-C5.0"><summary>
With the <code>"C5.0"</code> engine
</summary><h3>
Classification Example (<code>C5.0</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">bt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/boost_tree.html">boost_tree</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"C5.0"</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Boosted Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 15</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: C5.0</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">bt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">bt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## C5.0.default(x = x, y = y, trials = 15, control</span></span>
<span>  <span class="co">##  = C50::C5.0Control(minCases = 2, sample = 0))</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Classification Tree</span></span>
<span>  <span class="co">## Number of samples: 781 </span></span>
<span>  <span class="co">## Number of predictors: 2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of boosting iterations: 15 requested;  6 used due to early stopping</span></span>
<span>  <span class="co">## Average tree size: 3.2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Non-standard options: attempt to group attributes</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">bt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.311        0.689</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.863        0.137</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.535        0.465</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.336        0.664</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.336        0.664</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.137        0.863</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.496        0.504</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.311        0.689</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             1            0    </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0            1</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="decision_tree-models">
<code>decision_tree()</code> models<a class="anchor" aria-label="anchor" href="#decision_tree-models"></a>
</h2>
<details id="decision-tree-rpart"><summary>
With the <code>"rpart"</code> engine
</summary><h3>
Regression Example (<code>rpart</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>tree_depth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   tree_depth = 30</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: rpart</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_fit</span> <span class="op">&lt;-</span> <span class="va">dt_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## n= 5691 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## node), split, n, deviance, yval</span></span>
<span>  <span class="co">##       * denotes terminal node</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## 1) root 5691 244958.800 13.615560  </span></span>
<span>  <span class="co">##   2) Quincy_Wells&lt; 2.737 1721  22973.630  5.194394  </span></span>
<span>  <span class="co">##     4) Clark_Lake&lt; 5.07 1116  13166.830  4.260215 *</span></span>
<span>  <span class="co">##     5) Clark_Lake&gt;=5.07 605   7036.349  6.917607 *</span></span>
<span>  <span class="co">##   3) Quincy_Wells&gt;=2.737 3970  47031.540 17.266140  </span></span>
<span>  <span class="co">##     6) Clark_Lake&lt; 17.6965 1940  16042.090 15.418210 *</span></span>
<span>  <span class="co">##     7) Clark_Lake&gt;=17.6965 2030  18033.560 19.032140 *</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.92</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.92</span></span></code></pre>
<h3>
Classification Example (<code>rpart</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>tree_depth <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"rpart"</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   tree_depth = 30</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: rpart</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">dt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## n= 781 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## node), split, n, loss, yval, (yprob)</span></span>
<span>  <span class="co">##       * denotes terminal node</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##  1) root 781 348 Class1 (0.5544174 0.4455826)  </span></span>
<span>  <span class="co">##    2) B&lt; 1.495535 400  61 Class1 (0.8475000 0.1525000) *</span></span>
<span>  <span class="co">##    3) B&gt;=1.495535 381  94 Class2 (0.2467192 0.7532808)  </span></span>
<span>  <span class="co">##      6) B&lt; 2.079458 191  70 Class2 (0.3664921 0.6335079)  </span></span>
<span>  <span class="co">##       12) A&gt;=2.572663 48  13 Class1 (0.7291667 0.2708333) *</span></span>
<span>  <span class="co">##       13) A&lt; 2.572663 143  35 Class2 (0.2447552 0.7552448) *</span></span>
<span>  <span class="co">##      7) B&gt;=2.079458 190  24 Class2 (0.1263158 0.8736842) *</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.729        0.271</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.729        0.271</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.126        0.874</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.245        0.755</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.848        0.152</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.126        0.874</span></span></code></pre>
</details><details id="decision-tree-C5.0"><summary>
With the <code>"C5.0"</code> engine
</summary><h3>
Classification Example (<code>C5.0</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">dt_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/decision_tree.html">decision_tree</a></span><span class="op">(</span>min_n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"C5.0"</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Decision Tree Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   min_n = 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: C5.0</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span> <span class="op">&lt;-</span> <span class="va">dt_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">dt_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## C5.0.default(x = x, y = y, trials = 1, control</span></span>
<span>  <span class="co">##  = C50::C5.0Control(minCases = 2, sample = 0))</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Classification Tree</span></span>
<span>  <span class="co">## Number of samples: 781 </span></span>
<span>  <span class="co">## Number of predictors: 2 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Tree size: 4 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Non-standard options: attempt to group attributes</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">dt_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.727        0.273</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.727        0.273</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.118        0.882</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.233        0.767</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.847        0.153</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.118        0.882</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="gen_additive_mod-models">
<code>gen_additive_mod()</code> models<a class="anchor" aria-label="anchor" href="#gen_additive_mod-models"></a>
</h2>
<details id="gen-additive-mod-mgcv"><summary>
With the <code>"mgcv"</code> engine
</summary><h3>
Regression Example (<code>mgcv</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">gam_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/gen_additive_mod.html">gen_additive_mod</a></span><span class="op">(</span>select_features <span class="op">=</span> <span class="cn">FALSE</span>, adjust_deg_free <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## GAM Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   select_features = FALSE</span></span>
<span>  <span class="co">##   adjust_deg_free = 10</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: mgcv</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_fit</span> <span class="op">&lt;-</span> <span class="va">gam_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">Clark_Lake</span> <span class="op">+</span> <span class="va">Quincy_Wells</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">gam_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Family: gaussian </span></span>
<span>  <span class="co">## Link function: identity </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Formula:</span></span>
<span>  <span class="co">## ridership ~ Clark_Lake + Quincy_Wells</span></span>
<span>  <span class="co">## Total model degrees of freedom 3 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## GCV score: 9.505245</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
<h3>
Classification Example (<code>mgcv</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">gam_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/gen_additive_mod.html">gen_additive_mod</a></span><span class="op">(</span>select_features <span class="op">=</span> <span class="cn">FALSE</span>, adjust_deg_free <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"mgcv"</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## GAM Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   select_features = FALSE</span></span>
<span>  <span class="co">##   adjust_deg_free = 10</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: mgcv</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_fit</span> <span class="op">&lt;-</span> <span class="va">gam_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">gam_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Family: binomial </span></span>
<span>  <span class="co">## Link function: logit </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Formula:</span></span>
<span>  <span class="co">## Class ~ A + B</span></span>
<span>  <span class="co">## Total model degrees of freedom 3 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## UBRE score: -0.07548008</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gam_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.091<span style="text-decoration: underline;">3</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.648      0.352  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.567      0.433  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">82</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="linear_reg-models">
<code>linear_reg()</code> models<a class="anchor" aria-label="anchor" href="#linear_reg-models"></a>
</h2>
<details id="linear-reg-lm"><summary>
With the <code>"lm"</code> engine
</summary><h3>
Regression Example (<code>lm</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: lm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## stats::lm(formula = ridership ~ ., data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">##  (Intercept)    Clark_Lake  Quincy_Wells  </span></span>
<span>  <span class="co">##       1.6624        0.7738        0.2557</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details><details id="linear-reg-glm"><summary>
With the <code>"glm"</code> engine
</summary><h3>
Regression Example (<code>glm</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  stats::glm(formula = ridership ~ ., family = stats::gaussian, </span></span>
<span>  <span class="co">##     data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">##  (Intercept)    Clark_Lake  Quincy_Wells  </span></span>
<span>  <span class="co">##       1.6624        0.7738        0.2557  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of Freedom: 5690 Total (i.e. Null);  5688 Residual</span></span>
<span>  <span class="co">## Null Deviance:     245000 </span></span>
<span>  <span class="co">## Residual Deviance: 53530   AIC: 28910</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details><details id="linear-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Regression Example (<code>glmnet</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "gaussian") </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##    Df  %Dev Lambda</span></span>
<span>  <span class="co">## 1   0  0.00 5.7970</span></span>
<span>  <span class="co">## 2   1 13.25 5.2820</span></span>
<span>  <span class="co">## 3   1 24.26 4.8130</span></span>
<span>  <span class="co">## 4   1 33.40 4.3850</span></span>
<span>  <span class="co">## 5   1 40.98 3.9960</span></span>
<span>  <span class="co">## 6   1 47.28 3.6410</span></span>
<span>  <span class="co">## 7   1 52.51 3.3170</span></span>
<span>  <span class="co">## 8   1 56.85 3.0220</span></span>
<span>  <span class="co">## 9   1 60.45 2.7540</span></span>
<span>  <span class="co">## 10  1 63.44 2.5090</span></span>
<span>  <span class="co">## 11  1 65.92 2.2860</span></span>
<span>  <span class="co">## 12  1 67.99 2.0830</span></span>
<span>  <span class="co">## 13  1 69.70 1.8980</span></span>
<span>  <span class="co">## 14  1 71.12 1.7300</span></span>
<span>  <span class="co">## 15  1 72.30 1.5760</span></span>
<span>  <span class="co">## 16  2 73.29 1.4360</span></span>
<span>  <span class="co">## 17  2 74.11 1.3080</span></span>
<span>  <span class="co">## 18  2 74.80 1.1920</span></span>
<span>  <span class="co">## 19  2 75.37 1.0860</span></span>
<span>  <span class="co">## 20  2 75.84 0.9897</span></span>
<span>  <span class="co">## 21  2 76.23 0.9018</span></span>
<span>  <span class="co">## 22  2 76.56 0.8217</span></span>
<span>  <span class="co">## 23  2 76.83 0.7487</span></span>
<span>  <span class="co">## 24  2 77.05 0.6822</span></span>
<span>  <span class="co">## 25  2 77.24 0.6216</span></span>
<span>  <span class="co">## 26  2 77.39 0.5664</span></span>
<span>  <span class="co">## 27  2 77.52 0.5160</span></span>
<span>  <span class="co">## 28  2 77.63 0.4702</span></span>
<span>  <span class="co">## 29  2 77.72 0.4284</span></span>
<span>  <span class="co">## 30  2 77.79 0.3904</span></span>
<span>  <span class="co">## 31  2 77.85 0.3557</span></span>
<span>  <span class="co">## 32  2 77.90 0.3241</span></span>
<span>  <span class="co">## 33  2 77.94 0.2953</span></span>
<span>  <span class="co">## 34  2 77.98 0.2691</span></span>
<span>  <span class="co">## 35  2 78.01 0.2452</span></span>
<span>  <span class="co">## 36  2 78.03 0.2234</span></span>
<span>  <span class="co">## 37  2 78.05 0.2035</span></span>
<span>  <span class="co">## 38  2 78.07 0.1855</span></span>
<span>  <span class="co">## 39  2 78.08 0.1690</span></span>
<span>  <span class="co">## 40  2 78.09 0.1540</span></span>
<span>  <span class="co">## 41  2 78.10 0.1403</span></span>
<span>  <span class="co">## 42  2 78.11 0.1278</span></span>
<span>  <span class="co">## 43  2 78.12 0.1165</span></span>
<span>  <span class="co">## 44  2 78.12 0.1061</span></span>
<span>  <span class="co">## 45  2 78.13 0.0967</span></span>
<span>  <span class="co">## 46  2 78.13 0.0881</span></span>
<span>  <span class="co">## 47  2 78.13 0.0803</span></span>
<span>  <span class="co">## 48  2 78.14 0.0732</span></span>
<span>  <span class="co">## 49  2 78.14 0.0666</span></span>
<span>  <span class="co">## 50  2 78.14 0.0607</span></span>
<span>  <span class="co">## 51  2 78.14 0.0553</span></span>
<span>  <span class="co">## 52  2 78.14 0.0504</span></span>
<span>  <span class="co">## 53  2 78.14 0.0459</span></span>
<span>  <span class="co">## 54  2 78.15 0.0419</span></span>
<span>  <span class="co">## 55  2 78.15 0.0381</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.57</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.15</span></span></code></pre>
</details><details id="linear-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Regression Example (<code>keras</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb99"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Epoch 1/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 755.6931 - 466ms/epoch - 3ms/step</span></span>
<span>  <span class="co">## Epoch 2/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 525.4405 - 172ms/epoch - 966us/step</span></span>
<span>  <span class="co">## Epoch 3/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 396.3113 - 155ms/epoch - 868us/step</span></span>
<span>  <span class="co">## Epoch 4/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 319.7770 - 154ms/epoch - 865us/step</span></span>
<span>  <span class="co">## Epoch 5/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 272.5349 - 157ms/epoch - 880us/step</span></span>
<span>  <span class="co">## Epoch 6/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 242.3961 - 153ms/epoch - 862us/step</span></span>
<span>  <span class="co">## Epoch 7/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 222.5360 - 152ms/epoch - 855us/step</span></span>
<span>  <span class="co">## Epoch 8/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 208.7940 - 152ms/epoch - 857us/step</span></span>
<span>  <span class="co">## Epoch 9/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 198.2968 - 152ms/epoch - 856us/step</span></span>
<span>  <span class="co">## Epoch 10/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 188.5746 - 168ms/epoch - 942us/step</span></span>
<span>  <span class="co">## Epoch 11/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 176.6399 - 164ms/epoch - 919us/step</span></span>
<span>  <span class="co">## Epoch 12/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 157.8513 - 152ms/epoch - 856us/step</span></span>
<span>  <span class="co">## Epoch 13/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 126.1244 - 152ms/epoch - 855us/step</span></span>
<span>  <span class="co">## Epoch 14/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 81.1750 - 153ms/epoch - 857us/step</span></span>
<span>  <span class="co">## Epoch 15/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 39.1228 - 155ms/epoch - 872us/step</span></span>
<span>  <span class="co">## Epoch 16/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 17.2623 - 152ms/epoch - 856us/step</span></span>
<span>  <span class="co">## Epoch 17/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 11.2897 - 153ms/epoch - 862us/step</span></span>
<span>  <span class="co">## Epoch 18/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 10.3598 - 152ms/epoch - 855us/step</span></span>
<span>  <span class="co">## Epoch 19/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 10.2638 - 153ms/epoch - 859us/step</span></span>
<span>  <span class="co">## Epoch 20/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 10.2517 - 151ms/epoch - 850us/step</span></span></code></pre>
<div class="sourceCode" id="cb101"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense (Dense)                   (None, 1)                    3           </span></span>
<span>  <span class="co">##  dense_1 (Dense)                 (None, 1)                    2           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 5 (20.00 Byte)</span></span>
<span>  <span class="co">## Trainable params: 5 (20.00 Byte)</span></span>
<span>  <span class="co">## Non-trainable params: 0 (0.00 Byte)</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb103"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## 1/1 - 0s - 47ms/epoch - 47ms/step</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 19.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 19.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 19.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.94</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.27</span></span></code></pre>
</details><details id="linear-reg-stan"><summary>
With the <code>"stan"</code> engine
</summary><h3>
Regression Example (<code>stan</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb106"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb107"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"stan"</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: stan</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## stan_glm</span></span>
<span>  <span class="co">##  family:       gaussian [identity]</span></span>
<span>  <span class="co">##  formula:      ridership ~ .</span></span>
<span>  <span class="co">##  observations: 5691</span></span>
<span>  <span class="co">##  predictors:   3</span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">##              Median MAD_SD</span></span>
<span>  <span class="co">## (Intercept)  1.7    0.1   </span></span>
<span>  <span class="co">## Clark_Lake   0.8    0.0   </span></span>
<span>  <span class="co">## Quincy_Wells 0.3    0.1   </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Auxiliary parameter(s):</span></span>
<span>  <span class="co">##       Median MAD_SD</span></span>
<span>  <span class="co">## sigma 3.1    0.0   </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">## * For help interpreting the printed output see ?print.stanreg</span></span>
<span>  <span class="co">## * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.45</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  7.02</span></span></code></pre>
</details><details id="linear-reg-quantreg"><summary>
With the <code>"quantreg"</code> engine
</summary><h3>
Quantile regression Example (<code>quantreg</code>)
</h3>
<p>We’ll model the relationship between the cost of a house in
Sacramento CA and the square footage of a property. A few rows were
randomly held out for illustrating prediction.</p>
<div class="sourceCode" id="cb113"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">sac_holdout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90L</span>, <span class="fl">203L</span>, <span class="fl">264L</span>, <span class="fl">733L</span>, <span class="fl">771L</span><span class="op">)</span></span>
<span>  <span class="va">sac_train</span> <span class="op">&lt;-</span> <span class="va">Sacramento</span><span class="op">[</span><span class="op">-</span><span class="va">sac_holdout</span>, <span class="op">]</span></span>
<span>  <span class="va">sac_test</span>  <span class="op">&lt;-</span> <span class="va">Sacramento</span><span class="op">[</span> <span class="va">sac_holdout</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model but should set the model mode. Also, for
these models the levels of the distirunbtion that we would like to
predict need to specified with the mode using the
<code>quantile_levels</code> argument. Let’s predict the 0.25, 0.50, and
0.75 quantiles:</p>
<div class="sourceCode" id="cb114"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">linreg_quant_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/linear_reg.html">linear_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"quantreg"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"quantile regression"</span>, quantile_levels <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  <span class="va">linreg_quant_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Regression Model Specification (quantile regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: quantreg</span></span></code></pre>
<pre><code><span>  <span class="co">## Quantile levels: 0.25, 0.5, and 0.75.</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb117"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">linreg_quant_fit</span> <span class="op">&lt;-</span> <span class="va">linreg_quant_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">price</span> <span class="op">~</span> <span class="va">sqft</span>, data <span class="op">=</span> <span class="va">sac_train</span><span class="op">)</span></span>
<span>  <span class="va">linreg_quant_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">## quantreg::rq(formula = price ~ sqft, tau = quantile_levels, data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">##              tau= 0.25 tau= 0.50  tau= 0.75</span></span>
<span>  <span class="co">## (Intercept) -8492.1136  6124.895 19605.2632</span></span>
<span>  <span class="co">## sqft          116.7192   135.865   159.2798</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of freedom: 927 total; 925 residual</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb119"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">quant_pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">linreg_quant_fit</span>, <span class="va">sac_test</span><span class="op">)</span></span>
<span>  <span class="va">quant_pred</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 5 × 1</span></span></span>
<span>  <span class="co">##   .pred_quantile</span></span>
<span>  <span class="co">##        <span style="color: #949494; font-style: italic;">&lt;qtls(3)&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>       [206000]</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>       [156000]</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>       [246000]</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>       [284000]</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>       [208000]</span></span></code></pre>
<p><code>.pred_quantile</code> is a vector type that contains all of the
quartile predictions for each row. You can convert this to a rectangular
data set using either of:</p>
<div class="sourceCode" id="cb121"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">quant_pred</span><span class="op">$</span><span class="va">.pred_quantile</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##          [,1]     [,2]     [,3]</span></span>
<span>  <span class="co">## [1,] 163435.3 206254.0 254224.4</span></span>
<span>  <span class="co">## [2,] 120365.9 156119.8 195450.1</span></span>
<span>  <span class="co">## [3,] 197867.5 246334.2 301211.9</span></span>
<span>  <span class="co">## [4,] 230548.9 284376.4 345810.2</span></span>
<span>  <span class="co">## [5,] 164836.0 207884.4 256135.7</span></span></code></pre>
<div class="sourceCode" id="cb123"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="co"># or </span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="va">quant_pred</span><span class="op">$</span><span class="va">.pred_quantile</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 15 × 3</span></span></span>
<span>  <span class="co">##    .pred_quantile .quantile_levels  .row</span></span>
<span>  <span class="co">##             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span>        <span style="text-decoration: underline;">163</span>435.             0.25     1</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span>        <span style="text-decoration: underline;">206</span>254.             0.5      1</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span>        <span style="text-decoration: underline;">254</span>224.             0.75     1</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span>        <span style="text-decoration: underline;">120</span>366.             0.25     2</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span>        <span style="text-decoration: underline;">156</span>120.             0.5      2</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span>        <span style="text-decoration: underline;">195</span>450.             0.75     2</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span>        <span style="text-decoration: underline;">197</span>868.             0.25     3</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span>        <span style="text-decoration: underline;">246</span>334.             0.5      3</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span>        <span style="text-decoration: underline;">301</span>212.             0.75     3</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span>        <span style="text-decoration: underline;">230</span>549.             0.25     4</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">11</span>        <span style="text-decoration: underline;">284</span>376.             0.5      4</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">12</span>        <span style="text-decoration: underline;">345</span>810.             0.75     4</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">13</span>        <span style="text-decoration: underline;">164</span>836.             0.25     5</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">14</span>        <span style="text-decoration: underline;">207</span>884.             0.5      5</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">15</span>        <span style="text-decoration: underline;">256</span>136.             0.75     5</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="logistic_reg-models">
<code>logistic_reg()</code> models<a class="anchor" aria-label="anchor" href="#logistic_reg-models"></a>
</h2>
<details id="logistic-reg-glm"><summary>
With the <code>"glm"</code> engine
</summary><h3>
Classification Example (<code>glm</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb125"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb126"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glm"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glm</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  stats::glm(formula = Class ~ ., family = stats::binomial, data = data)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Coefficients:</span></span>
<span>  <span class="co">## (Intercept)            A            B  </span></span>
<span>  <span class="co">##      -3.755       -1.259        3.855  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Degrees of Freedom: 780 Total (i.e. Null);  778 Residual</span></span>
<span>  <span class="co">## Null Deviance:     1073 </span></span>
<span>  <span class="co">## Residual Deviance: 662.1   AIC: 668.1</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.091<span style="text-decoration: underline;">3</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.648      0.352  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.567      0.433  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">82</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details><details id="logistic-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Classification Example (<code>glmnet</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "binomial") </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##    Df  %Dev   Lambda</span></span>
<span>  <span class="co">## 1   0  0.00 0.308500</span></span>
<span>  <span class="co">## 2   1  4.76 0.281100</span></span>
<span>  <span class="co">## 3   1  8.75 0.256100</span></span>
<span>  <span class="co">## 4   1 12.13 0.233300</span></span>
<span>  <span class="co">## 5   1 15.01 0.212600</span></span>
<span>  <span class="co">## 6   1 17.50 0.193700</span></span>
<span>  <span class="co">## 7   1 19.64 0.176500</span></span>
<span>  <span class="co">## 8   1 21.49 0.160800</span></span>
<span>  <span class="co">## 9   1 23.10 0.146500</span></span>
<span>  <span class="co">## 10  1 24.49 0.133500</span></span>
<span>  <span class="co">## 11  1 25.71 0.121700</span></span>
<span>  <span class="co">## 12  1 26.76 0.110900</span></span>
<span>  <span class="co">## 13  1 27.67 0.101000</span></span>
<span>  <span class="co">## 14  1 28.46 0.092030</span></span>
<span>  <span class="co">## 15  1 29.15 0.083860</span></span>
<span>  <span class="co">## 16  1 29.74 0.076410</span></span>
<span>  <span class="co">## 17  1 30.25 0.069620</span></span>
<span>  <span class="co">## 18  1 30.70 0.063430</span></span>
<span>  <span class="co">## 19  1 31.08 0.057800</span></span>
<span>  <span class="co">## 20  1 31.40 0.052660</span></span>
<span>  <span class="co">## 21  1 31.68 0.047990</span></span>
<span>  <span class="co">## 22  1 31.92 0.043720</span></span>
<span>  <span class="co">## 23  1 32.13 0.039840</span></span>
<span>  <span class="co">## 24  2 32.70 0.036300</span></span>
<span>  <span class="co">## 25  2 33.50 0.033070</span></span>
<span>  <span class="co">## 26  2 34.18 0.030140</span></span>
<span>  <span class="co">## 27  2 34.78 0.027460</span></span>
<span>  <span class="co">## 28  2 35.29 0.025020</span></span>
<span>  <span class="co">## 29  2 35.72 0.022800</span></span>
<span>  <span class="co">## 30  2 36.11 0.020770</span></span>
<span>  <span class="co">## 31  2 36.43 0.018930</span></span>
<span>  <span class="co">## 32  2 36.71 0.017250</span></span>
<span>  <span class="co">## 33  2 36.96 0.015710</span></span>
<span>  <span class="co">## 34  2 37.16 0.014320</span></span>
<span>  <span class="co">## 35  2 37.34 0.013050</span></span>
<span>  <span class="co">## 36  2 37.49 0.011890</span></span>
<span>  <span class="co">## 37  2 37.62 0.010830</span></span>
<span>  <span class="co">## 38  2 37.73 0.009868</span></span>
<span>  <span class="co">## 39  2 37.82 0.008992</span></span>
<span>  <span class="co">## 40  2 37.90 0.008193</span></span>
<span>  <span class="co">## 41  2 37.97 0.007465</span></span>
<span>  <span class="co">## 42  2 38.02 0.006802</span></span>
<span>  <span class="co">## 43  2 38.07 0.006198</span></span>
<span>  <span class="co">## 44  2 38.11 0.005647</span></span>
<span>  <span class="co">## 45  2 38.15 0.005145</span></span>
<span>  <span class="co">## 46  2 38.18 0.004688</span></span>
<span>  <span class="co">## 47  2 38.20 0.004272</span></span>
<span>  <span class="co">## 48  2 38.22 0.003892</span></span>
<span>  <span class="co">## 49  2 38.24 0.003547</span></span>
<span>  <span class="co">## 50  2 38.25 0.003231</span></span>
<span>  <span class="co">## 51  2 38.26 0.002944</span></span>
<span>  <span class="co">## 52  2 38.27 0.002683</span></span>
<span>  <span class="co">## 53  2 38.28 0.002444</span></span>
<span>  <span class="co">## 54  2 38.29 0.002227</span></span>
<span>  <span class="co">## 55  2 38.29 0.002029</span></span>
<span>  <span class="co">## 56  2 38.30 0.001849</span></span>
<span>  <span class="co">## 57  2 38.30 0.001685</span></span>
<span>  <span class="co">## 58  2 38.31 0.001535</span></span>
<span>  <span class="co">## 59  2 38.31 0.001399</span></span>
<span>  <span class="co">## 60  2 38.31 0.001275</span></span>
<span>  <span class="co">## 61  2 38.31 0.001161</span></span>
<span>  <span class="co">## 62  2 38.32 0.001058</span></span>
<span>  <span class="co">## 63  2 38.32 0.000964</span></span>
<span>  <span class="co">## 64  2 38.32 0.000879</span></span>
<span>  <span class="co">## 65  2 38.32 0.000800</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.530        0.470</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.713        0.287</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.616        0.384</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.416        0.584</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.417        0.583</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.288        0.712</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.554        0.446</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.557        0.443</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.820        0.180</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.206        0.794</span></span></code></pre>
</details><details id="logistic-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Classification Example (<code>keras</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb140"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Epoch 1/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.3285 - 373ms/epoch - 15ms/step</span></span>
<span>  <span class="co">## Epoch 2/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.2544 - 24ms/epoch - 951us/step</span></span>
<span>  <span class="co">## Epoch 3/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.1869 - 24ms/epoch - 963us/step</span></span>
<span>  <span class="co">## Epoch 4/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.1266 - 24ms/epoch - 955us/step</span></span>
<span>  <span class="co">## Epoch 5/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.0710 - 24ms/epoch - 956us/step</span></span>
<span>  <span class="co">## Epoch 6/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 1.0225 - 24ms/epoch - 950us/step</span></span>
<span>  <span class="co">## Epoch 7/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.9804 - 24ms/epoch - 954us/step</span></span>
<span>  <span class="co">## Epoch 8/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.9417 - 24ms/epoch - 944us/step</span></span>
<span>  <span class="co">## Epoch 9/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.9087 - 24ms/epoch - 951us/step</span></span>
<span>  <span class="co">## Epoch 10/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.8796 - 25ms/epoch - 1000us/step</span></span>
<span>  <span class="co">## Epoch 11/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.8537 - 24ms/epoch - 963us/step</span></span>
<span>  <span class="co">## Epoch 12/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.8321 - 24ms/epoch - 970us/step</span></span>
<span>  <span class="co">## Epoch 13/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.8126 - 24ms/epoch - 965us/step</span></span>
<span>  <span class="co">## Epoch 14/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7961 - 24ms/epoch - 948us/step</span></span>
<span>  <span class="co">## Epoch 15/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7814 - 26ms/epoch - 1ms/step</span></span>
<span>  <span class="co">## Epoch 16/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7687 - 27ms/epoch - 1ms/step</span></span>
<span>  <span class="co">## Epoch 17/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7579 - 24ms/epoch - 964us/step</span></span>
<span>  <span class="co">## Epoch 18/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7481 - 24ms/epoch - 963us/step</span></span>
<span>  <span class="co">## Epoch 19/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7399 - 24ms/epoch - 964us/step</span></span>
<span>  <span class="co">## Epoch 20/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7329 - 24ms/epoch - 955us/step</span></span></code></pre>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_1"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_2 (Dense)                 (None, 1)                    3           </span></span>
<span>  <span class="co">##  dense_3 (Dense)                 (None, 2)                    4           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 7 (28.00 Byte)</span></span>
<span>  <span class="co">## Trainable params: 7 (28.00 Byte)</span></span>
<span>  <span class="co">## Non-trainable params: 0 (0.00 Byte)</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## 1/1 - 0s - 32ms/epoch - 32ms/step</span></span>
<span>  <span class="co">## 1/1 - 0s - 13ms/epoch - 13ms/step</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.339        0.661</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class2             0.350        0.650</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class2             0.418        0.582</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.134        0.866</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.201        0.799</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.147        0.853</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class2             0.261        0.739</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.358        0.642</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class2             0.202        0.798</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.106        0.894</span></span></code></pre>
</details><details id="logistic-reg-LiblineaR"><summary>
With the <code>"LiblineaR"</code> engine
</summary><h3>
Classification Example (<code>LiblineaR</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized logistic regression primal (L2R_LR)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 0</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##             A         B     Bias</span></span>
<span>  <span class="co">## [1,] 1.219818 -3.759034 3.674861</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $ClassNames</span></span>
<span>  <span class="co">## [1] Class1 Class2</span></span>
<span>  <span class="co">## Levels: Class1 Class2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.096<span style="text-decoration: underline;">4</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.604      0.396  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.442      0.558  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.210      0.790  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.702      0.298  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.993      0.006<span style="text-decoration: underline;">67</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.112      0.888</span></span></code></pre>
</details><details id="logistic-reg-stan"><summary>
With the <code>"stan"</code> engine
</summary><h3>
Classification Example (<code>stan</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">logreg_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/logistic_reg.html">logistic_reg</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"stan"</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Logistic Regression Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: stan</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span> <span class="op">&lt;-</span> <span class="va">logreg_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">logreg_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## stan_glm</span></span>
<span>  <span class="co">##  family:       binomial [logit]</span></span>
<span>  <span class="co">##  formula:      Class ~ .</span></span>
<span>  <span class="co">##  observations: 781</span></span>
<span>  <span class="co">##  predictors:   3</span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">##             Median MAD_SD</span></span>
<span>  <span class="co">## (Intercept) -3.8    0.3  </span></span>
<span>  <span class="co">## A           -1.3    0.2  </span></span>
<span>  <span class="co">## B            3.9    0.3  </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## ------</span></span>
<span>  <span class="co">## * For help interpreting the printed output see ?print.stanreg</span></span>
<span>  <span class="co">## * For info on the priors used see ?prior_summary.stanreg</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">logreg_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.518      0.482  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.909      0.090<span style="text-decoration: underline;">9</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.650      0.350  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.609      0.391  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.443      0.557  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.206      0.794  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.708      0.292  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.568      0.432  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.005<span style="text-decoration: underline;">80</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.108      0.892</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="mars-models">
<code>mars()</code> models<a class="anchor" aria-label="anchor" href="#mars-models"></a>
</h2>
<details id="mars-earth"><summary>
With the <code>"earth"</code> engine
</summary><h3>
Regression Example (<code>earth</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mars.html">mars</a></span><span class="op">(</span>prod_degree <span class="op">=</span> <span class="fl">1</span>, prune_method <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"earth"</span><span class="op">)</span></span>
<span>  <span class="va">mars_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## MARS Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   prod_degree = 1</span></span>
<span>  <span class="co">##   prune_method = backward</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: earth</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mars_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mars_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## </span></span>
<span>  <span class="co">## Attaching package: 'plotrix'</span></span></code></pre>
<pre><code><span>  <span class="co">## The following object is masked from 'package:scales':</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##     rescale</span></span></code></pre>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Selected 5 of 6 terms, and 2 of 2 predictors</span></span>
<span>  <span class="co">## Termination condition: RSq changed by less than 0.001 at 6 terms</span></span>
<span>  <span class="co">## Importance: Clark_Lake, Quincy_Wells</span></span>
<span>  <span class="co">## Number of terms at each degree of interaction: 1 4 (additive model)</span></span>
<span>  <span class="co">## GCV 9.085818    RSS 51543.98    GRSq 0.7889881    RSq 0.789581</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.7 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.99</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.68</span></span></code></pre>
<h3>
Classification Example (<code>earth</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mars_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mars.html">mars</a></span><span class="op">(</span>prod_degree <span class="op">=</span> <span class="fl">1</span>, prune_method <span class="op">=</span> <span class="st">"backward"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"earth"</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## MARS Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   prod_degree = 1</span></span>
<span>  <span class="co">##   prune_method = backward</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: earth</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mars_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">mars_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## GLM (family binomial, link logit):</span></span>
<span>  <span class="co">##  nulldev  df       dev  df   devratio     AIC iters converged</span></span>
<span>  <span class="co">##  1073.43 780   632.723 775      0.411   644.7     5         1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Earth selected 6 of 13 terms, and 2 of 2 predictors</span></span>
<span>  <span class="co">## Termination condition: Reached nk 21</span></span>
<span>  <span class="co">## Importance: B, A</span></span>
<span>  <span class="co">## Number of terms at each degree of interaction: 1 5 (additive model)</span></span>
<span>  <span class="co">## Earth GCV 0.1334948    RSS 101.3432    GRSq 0.461003    RSq 0.4747349</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mars_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.332       0.668  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.845       0.155  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.585       0.415  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.690       0.310  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.483       0.517  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.318       0.682  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.661       0.339  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.398       0.602  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.990       0.009<span style="text-decoration: underline;">72</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.062<span style="text-decoration: underline;">5</span>      0.938</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="mlp-models">
<code>mlp()</code> models<a class="anchor" aria-label="anchor" href="#mlp-models"></a>
</h2>
<details id="mlp-nnet"><summary>
With the <code>"nnet"</code> engine
</summary><h3>
Regression Example (<code>nnet</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 100</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## a 2-5-1 network with 21 weights</span></span>
<span>  <span class="co">## inputs: Clark_Lake Quincy_Wells </span></span>
<span>  <span class="co">## output(s): ridership </span></span>
<span>  <span class="co">## options were - linear output units</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  8.09</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.22</span></span></code></pre>
<h3>
Classification Example (<code>nnet</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 100</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## a 2-5-1 network with 21 weights</span></span>
<span>  <span class="co">## inputs: A B </span></span>
<span>  <span class="co">## output(s): Class </span></span>
<span>  <span class="co">## options were - entropy fitting</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.364        0.636</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.691        0.309</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.577        0.423</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.686        0.314</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.466        0.534</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.339        0.661</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.670        0.330</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.384        0.616</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.692        0.308</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.330        0.670</span></span></code></pre>
</details><details id="mlp-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Regression Example (<code>keras</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 20</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_reg_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Epoch 1/20</span></span>
<span>  <span class="co">## 178/178 - 1s - loss: 227.1551 - 522ms/epoch - 3ms/step</span></span>
<span>  <span class="co">## Epoch 2/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 195.0787 - 157ms/epoch - 883us/step</span></span>
<span>  <span class="co">## Epoch 3/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 179.8892 - 157ms/epoch - 883us/step</span></span>
<span>  <span class="co">## Epoch 4/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 167.6887 - 162ms/epoch - 909us/step</span></span>
<span>  <span class="co">## Epoch 5/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 158.7949 - 158ms/epoch - 889us/step</span></span>
<span>  <span class="co">## Epoch 6/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 150.8959 - 158ms/epoch - 887us/step</span></span>
<span>  <span class="co">## Epoch 7/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 143.6314 - 167ms/epoch - 936us/step</span></span>
<span>  <span class="co">## Epoch 8/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 136.8418 - 157ms/epoch - 884us/step</span></span>
<span>  <span class="co">## Epoch 9/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 130.4481 - 158ms/epoch - 886us/step</span></span>
<span>  <span class="co">## Epoch 10/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 124.4077 - 158ms/epoch - 887us/step</span></span>
<span>  <span class="co">## Epoch 11/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 118.6838 - 158ms/epoch - 886us/step</span></span>
<span>  <span class="co">## Epoch 12/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 113.2444 - 158ms/epoch - 886us/step</span></span>
<span>  <span class="co">## Epoch 13/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 108.0642 - 158ms/epoch - 890us/step</span></span>
<span>  <span class="co">## Epoch 14/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 103.1127 - 158ms/epoch - 889us/step</span></span>
<span>  <span class="co">## Epoch 15/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 98.3562 - 158ms/epoch - 890us/step</span></span>
<span>  <span class="co">## Epoch 16/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 93.7751 - 158ms/epoch - 889us/step</span></span>
<span>  <span class="co">## Epoch 17/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 89.3467 - 160ms/epoch - 898us/step</span></span>
<span>  <span class="co">## Epoch 18/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 85.0437 - 159ms/epoch - 891us/step</span></span>
<span>  <span class="co">## Epoch 19/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 80.7923 - 158ms/epoch - 886us/step</span></span>
<span>  <span class="co">## Epoch 20/20</span></span>
<span>  <span class="co">## 178/178 - 0s - loss: 76.6450 - 157ms/epoch - 885us/step</span></span></code></pre>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_2"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_4 (Dense)                 (None, 5)                    15          </span></span>
<span>  <span class="co">##  dense_5 (Dense)                 (None, 1)                    6           </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 21 (84.00 Byte)</span></span>
<span>  <span class="co">## Trainable params: 21 (84.00 Byte)</span></span>
<span>  <span class="co">## Non-trainable params: 0 (0.00 Byte)</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## 1/1 - 0s - 31ms/epoch - 31ms/step</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span>  7.80</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span>  7.80</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span>  7.80</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span>  7.80</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span>  7.80</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.12</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.96</span></span></code></pre>
<h3>
Classification Example (<code>keras</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/mlp.html">mlp</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0</span>, epochs <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Single Layer Neural Network Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   penalty = 0</span></span>
<span>  <span class="co">##   epochs = 20</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">mlp_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mlp_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Epoch 1/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7276 - 352ms/epoch - 14ms/step</span></span>
<span>  <span class="co">## Epoch 2/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7191 - 24ms/epoch - 965us/step</span></span>
<span>  <span class="co">## Epoch 3/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7119 - 24ms/epoch - 966us/step</span></span>
<span>  <span class="co">## Epoch 4/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7058 - 24ms/epoch - 975us/step</span></span>
<span>  <span class="co">## Epoch 5/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.7003 - 24ms/epoch - 970us/step</span></span>
<span>  <span class="co">## Epoch 6/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6954 - 25ms/epoch - 980us/step</span></span>
<span>  <span class="co">## Epoch 7/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6910 - 24ms/epoch - 971us/step</span></span>
<span>  <span class="co">## Epoch 8/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6872 - 25ms/epoch - 981us/step</span></span>
<span>  <span class="co">## Epoch 9/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6834 - 24ms/epoch - 970us/step</span></span>
<span>  <span class="co">## Epoch 10/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6800 - 24ms/epoch - 980us/step</span></span>
<span>  <span class="co">## Epoch 11/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6767 - 25ms/epoch - 981us/step</span></span>
<span>  <span class="co">## Epoch 12/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6736 - 24ms/epoch - 976us/step</span></span>
<span>  <span class="co">## Epoch 13/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6707 - 24ms/epoch - 964us/step</span></span>
<span>  <span class="co">## Epoch 14/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6676 - 25ms/epoch - 981us/step</span></span>
<span>  <span class="co">## Epoch 15/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6646 - 24ms/epoch - 980us/step</span></span>
<span>  <span class="co">## Epoch 16/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6616 - 24ms/epoch - 973us/step</span></span>
<span>  <span class="co">## Epoch 17/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6585 - 24ms/epoch - 967us/step</span></span>
<span>  <span class="co">## Epoch 18/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6554 - 25ms/epoch - 993us/step</span></span>
<span>  <span class="co">## Epoch 19/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6524 - 25ms/epoch - 982us/step</span></span>
<span>  <span class="co">## Epoch 20/20</span></span>
<span>  <span class="co">## 25/25 - 0s - loss: 0.6493 - 24ms/epoch - 976us/step</span></span></code></pre>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">mlp_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Model: "sequential_3"</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span>
<span>  <span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">##  dense_6 (Dense)                 (None, 5)                    15          </span></span>
<span>  <span class="co">##  dense_7 (Dense)                 (None, 2)                    12          </span></span>
<span>  <span class="co">## ==========================================================================</span></span>
<span>  <span class="co">## Total params: 27 (108.00 Byte)</span></span>
<span>  <span class="co">## Trainable params: 27 (108.00 Byte)</span></span>
<span>  <span class="co">## Non-trainable params: 0 (0.00 Byte)</span></span>
<span>  <span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mlp_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## 1/1 - 0s - 31ms/epoch - 31ms/step</span></span>
<span>  <span class="co">## 1/1 - 0s - 12ms/epoch - 12ms/step</span></span></code></pre>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.533        0.467</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.587        0.413</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.570        0.430</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class2             0.464        0.536</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.479        0.521</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.441        0.559</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.524        0.476</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.543        0.457</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.598        0.402</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.417        0.583</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="multinom_reg-models">
<code>multinom_reg()</code> models<a class="anchor" aria-label="anchor" href="#multinom_reg-models"></a>
</h2>
<details id="multinom-reg-glmnet"><summary>
With the <code>"glmnet"</code> engine
</summary><h3>
Classification Example (<code>glmnet</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"glmnet"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: glmnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  glmnet::glmnet(x = maybe_matrix(x), y = y, family = "multinomial") </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    Df  %Dev  Lambda</span></span>
<span><span class="co">## 1   0  0.00 0.31730</span></span>
<span><span class="co">## 2   1  3.43 0.28910</span></span>
<span><span class="co">## 3   1  6.30 0.26340</span></span>
<span><span class="co">## 4   1  8.74 0.24000</span></span>
<span><span class="co">## 5   1 10.83 0.21870</span></span>
<span><span class="co">## 6   1 12.62 0.19930</span></span>
<span><span class="co">## 7   1 14.17 0.18160</span></span>
<span><span class="co">## 8   1 15.51 0.16540</span></span>
<span><span class="co">## 9   1 16.67 0.15070</span></span>
<span><span class="co">## 10  1 17.68 0.13740</span></span>
<span><span class="co">## 11  1 18.56 0.12520</span></span>
<span><span class="co">## 12  2 19.93 0.11400</span></span>
<span><span class="co">## 13  2 21.31 0.10390</span></span>
<span><span class="co">## 14  2 22.50 0.09467</span></span>
<span><span class="co">## 15  2 23.52 0.08626</span></span>
<span><span class="co">## 16  2 24.40 0.07860</span></span>
<span><span class="co">## 17  2 25.16 0.07162</span></span>
<span><span class="co">## 18  2 25.81 0.06526</span></span>
<span><span class="co">## 19  2 26.37 0.05946</span></span>
<span><span class="co">## 20  2 26.86 0.05418</span></span>
<span><span class="co">## 21  2 27.27 0.04936</span></span>
<span><span class="co">## 22  2 27.63 0.04498</span></span>
<span><span class="co">## 23  2 27.94 0.04098</span></span>
<span><span class="co">## 24  2 28.21 0.03734</span></span>
<span><span class="co">## 25  2 28.44 0.03402</span></span>
<span><span class="co">## 26  2 28.63 0.03100</span></span>
<span><span class="co">## 27  2 28.80 0.02825</span></span>
<span><span class="co">## 28  2 28.94 0.02574</span></span>
<span><span class="co">## 29  2 29.06 0.02345</span></span>
<span><span class="co">## 30  2 29.17 0.02137</span></span>
<span><span class="co">## 31  2 29.26 0.01947</span></span>
<span><span class="co">## 32  2 29.33 0.01774</span></span>
<span><span class="co">## 33  2 29.39 0.01616</span></span>
<span><span class="co">## 34  2 29.45 0.01473</span></span>
<span><span class="co">## 35  2 29.49 0.01342</span></span>
<span><span class="co">## 36  2 29.53 0.01223</span></span>
<span><span class="co">## 37  2 29.56 0.01114</span></span>
<span><span class="co">## 38  2 29.59 0.01015</span></span>
<span><span class="co">## 39  2 29.61 0.00925</span></span>
<span><span class="co">## 40  2 29.63 0.00843</span></span>
<span><span class="co">## 41  2 29.65 0.00768</span></span>
<span><span class="co">## 42  2 29.67 0.00700</span></span>
<span><span class="co">## 43  2 29.68 0.00638</span></span>
<span><span class="co">## 44  2 29.69 0.00581</span></span>
<span><span class="co">## 45  2 29.70 0.00529</span></span>
<span><span class="co">## 46  2 29.71 0.00482</span></span>
<span><span class="co">## 47  2 29.71 0.00439</span></span>
<span><span class="co">## 48  2 29.72 0.00400</span></span>
<span><span class="co">## 49  2 29.72 0.00365</span></span>
<span><span class="co">## 50  2 29.73 0.00332</span></span>
<span><span class="co">## 51  2 29.73 0.00303</span></span>
<span><span class="co">## 52  2 29.74 0.00276</span></span>
<span><span class="co">## 53  2 29.74 0.00251</span></span>
<span><span class="co">## 54  2 29.74 0.00229</span></span>
<span><span class="co">## 55  2 29.75 0.00209</span></span>
<span><span class="co">## 56  2 29.75 0.00190</span></span>
<span><span class="co">## 57  2 29.75 0.00173</span></span>
<span><span class="co">## 58  2 29.75 0.00158</span></span>
<span><span class="co">## 59  2 29.75 0.00144</span></span>
<span><span class="co">## 60  2 29.75 0.00131</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Dream              0.339      0.448           0.214 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Biscoe             0.879      0.088<span style="text-decoration: underline;">2</span>          0.033<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Biscoe             0.539      0.317           0.144 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream              0.403      0.435           0.162 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Dream              0.297      0.481           0.221</span></span></code></pre>
</details><details id="multinom-reg-keras"><summary>
With the <code>"keras"</code> engine
</summary><h3>
Classification Example (<code>keras</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: keras</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Epoch 1/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 19.0972 - 337ms/epoch - 31ms/step</span></span>
<span><span class="co">## Epoch 2/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 18.4672 - 12ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 3/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 17.8494 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 4/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 17.2531 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 5/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 16.6584 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 6/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 16.0970 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 7/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 15.5350 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 8/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 14.9851 - 12ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 9/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 14.4585 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 10/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 13.9382 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 11/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 13.4418 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 12/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 12.9415 - 12ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 13/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 12.4654 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 14/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 12.0016 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 15/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 11.5648 - 12ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 16/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 11.1246 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 17/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 10.7078 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 18/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 10.3186 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 19/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 9.9427 - 11ms/epoch - 1ms/step</span></span>
<span><span class="co">## Epoch 20/20</span></span>
<span><span class="co">## 11/11 - 0s - loss: 9.5898 - 11ms/epoch - 1ms/step</span></span></code></pre>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model: "sequential_4"</span></span>
<span><span class="co">## __________________________________________________________________________</span></span>
<span><span class="co">##  Layer (type)                    Output Shape                 Param #     </span></span>
<span><span class="co">## ==========================================================================</span></span>
<span><span class="co">##  dense_8 (Dense)                 (None, 1)                    3           </span></span>
<span><span class="co">##  dense_9 (Dense)                 (None, 3)                    6           </span></span>
<span><span class="co">## ==========================================================================</span></span>
<span><span class="co">## Total params: 9 (36.00 Byte)</span></span>
<span><span class="co">## Trainable params: 9 (36.00 Byte)</span></span>
<span><span class="co">## Non-trainable params: 0 (0.00 Byte)</span></span>
<span><span class="co">## __________________________________________________________________________</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1/1 - 0s - 29ms/epoch - 29ms/step</span></span>
<span><span class="co">## 1/1 - 0s - 12ms/epoch - 12ms/step</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Dream           7.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-18</span>           1        1.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Dream           2.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-21</span>           1        9.60<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Dream           1.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-18</span>           1        5.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream           1.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-21</span>           1        5.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-14</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Dream           1.89<span style="color: #949494;">e</span><span style="color: #BB0000;">-18</span>           1        5.82<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span></span></span></code></pre>
</details><details id="multinom-reg-nnet"><summary>
With the <code>"nnet"</code> engine
</summary><h3>
Classification Example (<code>nnet</code>)
</h3>
<p>We’ll predict the island where the penguins were observed with two
variables in the same unit (mm): bill length and bill depth.</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">island</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"bill_"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">penguins_train</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">penguins_test</span>  <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">153</span>, <span class="fl">31</span>, <span class="fl">277</span>, <span class="fl">1</span><span class="op">)</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mr_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/multinom_reg.html">multinom_reg</a></span><span class="op">(</span>penalty <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"nnet"</span><span class="op">)</span></span>
<span><span class="va">mr_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Multinomial Regression Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   penalty = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: nnet</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span> <span class="op">&lt;-</span> <span class="va">mr_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">island</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">penguins_train</span><span class="op">)</span></span>
<span><span class="va">mr_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## nnet::multinom(formula = island ~ ., data = data, decay = ~0.1, </span></span>
<span><span class="co">##     trace = FALSE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##           (Intercept) bill_length_mm bill_depth_mm</span></span>
<span><span class="co">## Dream       -8.243575     -0.0580960     0.6168318</span></span>
<span><span class="co">## Torgersen   -1.610588     -0.2789588     0.6978480</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual Deviance: 502.5009 </span></span>
<span><span class="co">## AIC: 514.5009</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mr_cls_fit</span>, <span class="va">penguins_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 5 × 4</span></span></span>
<span><span class="co">##   .pred_class .pred_Biscoe .pred_Dream .pred_Torgersen</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Dream              0.193      0.450          0.357  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Biscoe             0.937      0.058<span style="text-decoration: underline;">2</span>         0.004<span style="text-decoration: underline;">87</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Biscoe             0.462      0.364          0.174  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Dream              0.450      0.495          0.055<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Dream              0.183      0.506          0.311</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="nearest_neighbor-models">
<code>nearest_neighbor()</code> models<a class="anchor" aria-label="anchor" href="#nearest_neighbor-models"></a>
</h2>
<details id="nearest-neighbor-kknn"><summary>
With the <code>"kknn"</code> engine
</summary><h3>
Regression Example (<code>kknn</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span><span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_reg_spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/nearest_neighbor.html">nearest_neighbor</a></span><span class="op">(</span>neighbors <span class="op">=</span> <span class="fl">5</span>, weight_func <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kknn"</span><span class="op">)</span></span>
<span><span class="va">knn_reg_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## K-Nearest Neighbor Model Specification (regression)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   neighbors = 5</span></span>
<span><span class="co">##   weight_func = triangular</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kknn</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_reg_fit</span> <span class="op">&lt;-</span> <span class="va">knn_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span><span class="va">knn_reg_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## kknn::train.kknn(formula = ridership ~ ., data = data, ks = min_rows(5,     data, 5), kernel = ~"triangular")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of response variable: continuous</span></span>
<span><span class="co">## minimal mean absolute error: 1.79223</span></span>
<span><span class="co">## Minimal mean squared error: 11.21809</span></span>
<span><span class="co">## Best kernel: triangular</span></span>
<span><span class="co">## Best k: 5</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span><span class="co">##   .pred</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 20.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 21.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 21.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 21.8 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 19.5 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  7.83</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>  5.54</span></span></code></pre>
<h3>
Classification Example (<code>kknn</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>Since there are two classes, we’ll use an odd number of neighbors to
avoid ties:</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_cls_spec</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/nearest_neighbor.html">nearest_neighbor</a></span><span class="op">(</span>neighbors <span class="op">=</span> <span class="fl">11</span>, weight_func <span class="op">=</span> <span class="st">"triangular"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kknn"</span><span class="op">)</span></span>
<span><span class="va">knn_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## K-Nearest Neighbor Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   neighbors = 11</span></span>
<span><span class="co">##   weight_func = triangular</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kknn</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">knn_cls_fit</span> <span class="op">&lt;-</span> <span class="va">knn_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span><span class="va">knn_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## kknn::train.kknn(formula = Class ~ ., data = data, ks = min_rows(11,     data, 5), kernel = ~"triangular")</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Type of response variable: nominal</span></span>
<span><span class="co">## Minimal misclassification: 0.1869398</span></span>
<span><span class="co">## Best kernel: triangular</span></span>
<span><span class="co">## Best k: 11</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2            0.177       0.823  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1            0.995       0.005<span style="text-decoration: underline;">15</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1            0.590       0.410  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1            0.770       0.230  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2            0.333       0.667  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2            0.182       0.818  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1            0.692       0.308  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2            0.400       0.600  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1            0.814       0.186  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Class2            0.027<span style="text-decoration: underline;">3</span>      0.973</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="rand_forest-models">
<code>rand_forest()</code> models<a class="anchor" aria-label="anchor" href="#rand_forest-models"></a>
</h2>
<details id="rand-forest-ranger"><summary>
With the <code>"ranger"</code> engine
</summary><h3>
Regression Example (<code>ranger</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: ranger</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span> <span class="op">&lt;-</span> <span class="va">rf_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Ranger result</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  ranger::ranger(x = maybe_data_frame(x), y = y, num.trees = ~200,      min.node.size = min_rows(~5, x), num.threads = 1, verbose = FALSE,      seed = sample.int(10^5, 1)) </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Type:                             Regression </span></span>
<span>  <span class="co">## Number of trees:                  200 </span></span>
<span>  <span class="co">## Sample size:                      5691 </span></span>
<span>  <span class="co">## Number of independent variables:  2 </span></span>
<span>  <span class="co">## Mtry:                             1 </span></span>
<span>  <span class="co">## Target node size:                 5 </span></span>
<span>  <span class="co">## Variable importance mode:         none </span></span>
<span>  <span class="co">## Splitrule:                        variance </span></span>
<span>  <span class="co">## OOB prediction error (MSE):       9.72953 </span></span>
<span>  <span class="co">## R squared (OOB):                  0.7739986</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.32</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.03</span></span></code></pre>
<h3>
Classification Example (<code>ranger</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: ranger</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span> <span class="op">&lt;-</span> <span class="va">rf_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Ranger result</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  ranger::ranger(x = maybe_data_frame(x), y = y, num.trees = ~200,      min.node.size = min_rows(~5, x), num.threads = 1, verbose = FALSE,      seed = sample.int(10^5, 1), probability = TRUE) </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Type:                             Probability estimation </span></span>
<span>  <span class="co">## Number of trees:                  200 </span></span>
<span>  <span class="co">## Sample size:                      781 </span></span>
<span>  <span class="co">## Number of independent variables:  2 </span></span>
<span>  <span class="co">## Mtry:                             1 </span></span>
<span>  <span class="co">## Target node size:                 5 </span></span>
<span>  <span class="co">## Variable importance mode:         none </span></span>
<span>  <span class="co">## Splitrule:                        gini </span></span>
<span>  <span class="co">## OOB prediction error (Brier s.):  0.1534794</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2           0.274         0.725 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1           0.928         0.071<span style="text-decoration: underline;">6</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class2           0.497         0.503 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1           0.703         0.297 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2           0.302         0.698 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2           0.151         0.849 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1           0.701         0.299 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1           0.592         0.409 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1           0.752         0.248 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2           0.002<span style="text-decoration: underline;">25</span>       0.998</span></span></code></pre>
</details><details id="rand-forest-randomForest"><summary>
With the <code>"randomForest"</code> engine
</summary><h3>
Regression Example (<code>randomForest</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: randomForest</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span> <span class="op">&lt;-</span> <span class="va">rf_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  randomForest(x = maybe_data_frame(x), y = y, ntree = ~200, nodesize = min_rows(~5,      x)) </span></span>
<span>  <span class="co">##                Type of random forest: regression</span></span>
<span>  <span class="co">##                      Number of trees: 200</span></span>
<span>  <span class="co">## No. of variables tried at each split: 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##           Mean of squared residuals: 9.696736</span></span>
<span>  <span class="co">##                     % Var explained: 77.47</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 20.9 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.3 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  7.33</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.16</span></span></code></pre>
<h3>
Classification Example (<code>randomForest</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">rf_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">200</span>, min_n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Random Forest Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   trees = 200</span></span>
<span>  <span class="co">##   min_n = 5</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: randomForest</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span> <span class="op">&lt;-</span> <span class="va">rf_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">rf_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Call:</span></span>
<span>  <span class="co">##  randomForest(x = maybe_data_frame(x), y = y, ntree = ~200, nodesize = min_rows(~5,      x)) </span></span>
<span>  <span class="co">##                Type of random forest: classification</span></span>
<span>  <span class="co">##                      Number of trees: 200</span></span>
<span>  <span class="co">## No. of variables tried at each split: 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">##         OOB estimate of  error rate: 19.72%</span></span>
<span>  <span class="co">## Confusion matrix:</span></span>
<span>  <span class="co">##        Class1 Class2 class.error</span></span>
<span>  <span class="co">## Class1    363     70   0.1616628</span></span>
<span>  <span class="co">## Class2     84    264   0.2413793</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">rf_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.23         0.77 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.95         0.05 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.59         0.41 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.75         0.25 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.305        0.695</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.105        0.895</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.685        0.315</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.63         0.37 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.79         0.21 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.02         0.98</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_linear-models">
<code>svm_linear()</code> models<a class="anchor" aria-label="anchor" href="#svm_linear-models"></a>
</h2>
<details id="svm-linear-LiblineaR"><summary>
With the <code>"LiblineaR"</code> engine
</summary><h3>
Regression Example (<code>LiblineaR</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized L2-loss support vector regression primal (L2R_L2LOSS_SVR)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 11</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##      Clark_Lake Quincy_Wells       Bias</span></span>
<span>  <span class="co">## [1,]  0.8277352    0.3430336 0.05042585</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb285"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 20.6 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.1 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 20.8 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 18.9 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.40</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  5.90</span></span></code></pre>
<h3>
Classification Example (<code>LiblineaR</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb287"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"LiblineaR"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: LiblineaR</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $TypeDetail</span></span>
<span>  <span class="co">## [1] "L2-regularized L2-loss support vector classification dual (L2R_L2LOSS_SVC_DUAL)"</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Type</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $W</span></span>
<span>  <span class="co">##              A         B     Bias</span></span>
<span>  <span class="co">## [1,] 0.4067922 -1.314783 1.321851</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $Bias</span></span>
<span>  <span class="co">## [1] 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $ClassNames</span></span>
<span>  <span class="co">## [1] Class1 Class2</span></span>
<span>  <span class="co">## Levels: Class1 Class2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## $NbClass</span></span>
<span>  <span class="co">## [1] 2</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## attr(,"class")</span></span>
<span>  <span class="co">## [1] "LiblineaR"</span></span></code></pre>
<p>The holdout data can be predicted for hard class predictions.</p>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 1</span></span></span>
<span>  <span class="co">##    .pred_class</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1     </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2</span></span></code></pre>
</details><details id="svm-linear-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb295"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb297"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb299"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: eps-svr  (regression) </span></span>
<span>  <span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Linear (vanilla) kernel function. </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 2283 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -825.1632 </span></span>
<span>  <span class="co">## Training error : 0.226456</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb301"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.87</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.41</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb303"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_linear.html">svm_linear</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Linear Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: C-svc  (classification) </span></span>
<span>  <span class="co">##  parameter : cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Linear (vanilla) kernel function. </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 353 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -349.425 </span></span>
<span>  <span class="co">## Training error : 0.174136 </span></span>
<span>  <span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.095<span style="text-decoration: underline;">6</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.445      0.555  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.212      0.788  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.704      0.296  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.006<span style="text-decoration: underline;">46</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.114      0.886</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_poly-models">
<code>svm_poly()</code> models<a class="anchor" aria-label="anchor" href="#svm_poly-models"></a>
</h2>
<details id="svm-poly-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span>  <span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_poly.html">svm_poly</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Polynomial Support Vector Machine Model Specification (regression)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">##   margin = 0.1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: eps-svr  (regression) </span></span>
<span>  <span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Polynomial kernel function. </span></span>
<span>  <span class="co">##  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 2283 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -825.1628 </span></span>
<span>  <span class="co">## Training error : 0.226471</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span>  <span class="co">##   .pred</span></span>
<span>  <span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">1</span> 21.0 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">3</span> 21.5 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">4</span> 21.2 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">6</span>  6.87</span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">7</span>  6.41</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span>  <span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/svm_poly.html">svm_poly</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>    <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span>  <span class="co">## Polynomial Support Vector Machine Model Specification (classification)</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Main Arguments:</span></span>
<span>  <span class="co">##   cost = 1</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">##  Setting default kernel parameters</span></span></code></pre>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span>  <span class="co">## parsnip model object</span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## SV type: C-svc  (classification) </span></span>
<span>  <span class="co">##  parameter : cost C = 1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Polynomial kernel function. </span></span>
<span>  <span class="co">##  Hyperparameters : degree =  1  scale =  1  offset =  1 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Number of Support Vectors : 353 </span></span>
<span>  <span class="co">## </span></span>
<span>  <span class="co">## Objective Function Value : -349.425 </span></span>
<span>  <span class="co">## Training error : 0.174136 </span></span>
<span>  <span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<pre><code><span>  <span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span>  <span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span>  <span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 1</span> Class1             0.517      0.483  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.904      0.095<span style="text-decoration: underline;">6</span> </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.645      0.355  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.610      0.390  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 5</span> Class2             0.445      0.555  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.212      0.788  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.704      0.296  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 8</span> Class1             0.565      0.435  </span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.994      0.006<span style="text-decoration: underline;">46</span></span></span>
<span>  <span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.114      0.886</span></span></code></pre>
</details>
</div>
<div class="section level2">
<h2 id="svm_rbf-models">
<code>svm_rbf()</code> models<a class="anchor" aria-label="anchor" href="#svm_rbf-models"></a>
</h2>
<details id="svm-rbf-kernlab"><summary>
With the <code>"kernlab"</code> engine
</summary><h3>
Regression Example (<code>kernlab</code>)
</h3>
<p>We’ll model the ridership on the Chicago elevated trains as a
function of the 14 day lagged ridership at two stations. The two
predictors are in the same units (rides per day/1000) and do not need to
be normalized. All but the last week of data are used for training. The
last week will be predicted after the model is fit.</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Chicago</span><span class="op">)</span></span>
<span><span class="va">Chicago</span> <span class="op">&lt;-</span> <span class="va">Chicago</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ridership</span>, <span class="va">Clark_Lake</span>, <span class="va">Quincy_Wells</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Chicago_train</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">Chicago_test</span> <span class="op">&lt;-</span> <span class="va">Chicago</span><span class="op">[</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">6</span><span class="op">)</span><span class="op">:</span><span class="va">n</span>, <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm_reg_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/svm_rbf.html">svm_rbf</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span>, margin <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span><span class="va">svm_reg_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Radial Basis Function Support Vector Machine Model Specification (regression)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   cost = 1</span></span>
<span><span class="co">##   margin = 0.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">svm_reg_fit</span> <span class="op">&lt;-</span> <span class="va">svm_reg_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">ridership</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">Chicago_train</span><span class="op">)</span></span>
<span><span class="va">svm_reg_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SV type: eps-svr  (regression) </span></span>
<span><span class="co">##  parameter : epsilon = 0.1  cost C = 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Gaussian Radial Basis kernel function. </span></span>
<span><span class="co">##  Hyperparameter : sigma =  10.8262370251485 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors : 2233 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Objective Function Value : -746.584 </span></span>
<span><span class="co">## Training error : 0.205567</span></span></code></pre>
<p>The holdout data can be predicted:</p>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_reg_fit</span>, <span class="va">Chicago_test</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 1</span></span></span>
<span><span class="co">##   .pred</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 20.7 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 21.2 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 21.3 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 21.1 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 19.4 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span>  6.77</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span>  6.13</span></span></code></pre>
<h3>
Classification Example (<code>kernlab</code>)
</h3>
<p>The example data has two predictors and an outcome with two classes.
Both predictors are in the same units.</p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://tidymodels.tidymodels.org/reference/tidymodels_prefer.html" class="external-link">tidymodels_prefer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_train</span> <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="va">data_test</span>  <span class="op">&lt;-</span> <span class="va">two_class_dat</span><span class="op">[</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> , <span class="op">]</span></span></code></pre></div>
<p>We can define the model with specific parameters:</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">svm_cls_spec</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/svm_rbf.html">svm_rbf</a></span><span class="op">(</span>cost <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># This model can be used for classification or regression, so set mode</span></span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_mode</a></span><span class="op">(</span><span class="st">"classification"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"kernlab"</span><span class="op">)</span></span>
<span><span class="va">svm_cls_spec</span></span></code></pre></div>
<pre><code><span><span class="co">## Radial Basis Function Support Vector Machine Model Specification (classification)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Main Arguments:</span></span>
<span><span class="co">##   cost = 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Computational engine: kernlab</span></span></code></pre>
<p>Now we create the model fit object:</p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">svm_cls_fit</span> <span class="op">&lt;-</span> <span class="va">svm_cls_spec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">data_train</span><span class="op">)</span></span>
<span><span class="va">svm_cls_fit</span></span></code></pre></div>
<pre><code><span><span class="co">## parsnip model object</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Support Vector Machine object of class "ksvm" </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## SV type: C-svc  (classification) </span></span>
<span><span class="co">##  parameter : cost C = 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Gaussian Radial Basis kernel function. </span></span>
<span><span class="co">##  Hyperparameter : sigma =  1.63216688499952 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Support Vectors : 327 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Objective Function Value : -294.4344 </span></span>
<span><span class="co">## Training error : 0.169014 </span></span>
<span><span class="co">## Probability model included.</span></span></code></pre>
<p>The holdout data can be predicted for both hard class predictions and
probabilities. We’ll bind these together into one tibble:</p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">svm_cls_fit</span>, <span class="va">data_test</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">##    .pred_class .pred_Class1 .pred_Class2</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Class2             0.238       0.762 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Class1             0.905       0.095<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Class1             0.619       0.381 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Class1             0.879       0.121 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Class1             0.641       0.359 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Class2             0.153       0.847 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Class1             0.745       0.255 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Class2             0.313       0.687 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Class1             0.878       0.122 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Class2             0.137       0.863</span></span></code></pre>
</details>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
