<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to parsnip • parsnip</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to parsnip">
<meta name="description" content="The goal of parsnip is to provide a tidy, unified interface to models to avoid
getting bogged down in the syntactical minutiae of the underlying software.
">
<meta property="og:description" content="The goal of parsnip is to provide a tidy, unified interface to models to avoid
getting bogged down in the syntactical minutiae of the underlying software.
">
<meta property="og:image" content="https://parsnip.tidymodels.org/logo.png">
<meta name="robots" content="noindex">
<script defer data-domain="parsnip.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">parsnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/parsnip.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/checklists.html">Dev checklists</a></li>
    <li><a class="dropdown-item" href="../articles/Examples.html">Fitting and predicting with parsnip</a></li>
    <li><a class="dropdown-item" href="../articles/Submodels.html">Evaluating submodels with the same model object</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-learn-more" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Learn more</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-learn-more">
<li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-ranger-glmnet/">Regression modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/models/parsnip-nnet/">Classification modeling</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidymodels.org/learn/develop/models/">Making a parsnip model from scratch</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/parsnip/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article" id="container">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to parsnip</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/parsnip/blob/main/vignettes/parsnip.Rmd" class="external-link"><code>vignettes/parsnip.Rmd</code></a></small>
      <div class="d-none name"><code>parsnip.Rmd</code></div>
    </div>

    
    
<p>This package provides functions and methods to create and manipulate
functions commonly used during modeling (e.g. fitting the model, making
predictions, etc). It allows the user to manipulate how the same type of
model can be created from different sources.</p>
<div class="section level3">
<h3 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h3>
<p>Modeling functions across different R packages can have very
different interfaces. If you would like to try different approaches,
there is a lot of syntactical minutiae to remember. The problem worsens
when you move in-between platforms (e.g. doing a logistic regression in
R’s <code>glm</code> versus Spark’s implementation).</p>
<p>parsnip tries to solve this by providing similar interfaces to
models. For example, if you are fitting a random forest model and would
like to adjust the number of trees in the forest there are different
argument names to remember:</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html" class="external-link">randomForest::randomForest</a></code> uses
<code>ntree</code>,</li>
<li>
<code><a href="http://imbs-hl.github.io/ranger/reference/ranger.html" class="external-link">ranger::ranger</a></code> uses <code>num.trees</code>,<br>
</li>
<li>Spark’s <code><a href="https://rdrr.io/pkg/sparklyr/man/ml_random_forest.html" class="external-link">sparklyr::ml_random_forest</a></code> uses
<code>num_trees</code>.</li>
</ul>
<p>Rather than remembering these values, a common interface to these
models can be used with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/parsnip" class="external-link">parsnip</a></span><span class="op">)</span></span>
<span><span class="va">rf_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span></code></pre></div>
<p>The package makes the translation between <code>trees</code> and the
real names in each of the implementations.</p>
<p>Some terminology:</p>
<ul>
<li>The <strong>model type</strong> differentiates models. Example types
are: random forests, logistic regression, linear support vector
machines, etc.</li>
<li>The <strong>mode</strong> of the model denotes how it will be used.
Two common modes are <em>classification</em> and <em>regression</em>.
Others would include “censored regression” and “risk regression”
(parametric and Cox PH models for censored data, respectively), as well
as unsupervised models (e.g. “clustering”).</li>
<li>The <strong>computational engine</strong> indicates how the actual
model might be fit. These are often R packages (such as
<code>randomForest</code> or <code>ranger</code>) but might also be
methods outside of R (e.g. Stan, Spark, and others).</li>
</ul>
<p>The parsnip package, similar to ggplot2, dplyr and recipes, separates
the specification of what you want to do from the actual doing. This
allows us to create broader functionality for modeling.</p>
</div>
<div class="section level3">
<h3 id="placeholders-for-parameters">Placeholders for Parameters<a class="anchor" aria-label="anchor" href="#placeholders-for-parameters"></a>
</h3>
<p>There are times where you would like to change a parameter from its
default but you are not sure what the final value will be. This is the
basis for <em>model tuning</em> where we use the <a href="https://tune.tidymodels.org/" class="external-link">tune</a> package. Since the model is
not executing when created, these types of parameters can be changed
using the <code><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune()</a></code> function. This provides a simple
placeholder for the value.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tune_mtry</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">2000</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tune_mtry</span></span>
<span><span class="co">#&gt; Random Forest Model Specification (unknown mode)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   mtry = tune()</span></span>
<span><span class="co">#&gt;   trees = 2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: ranger</span></span></code></pre></div>
<p>This will come in handy later when we fit the model over different
values of <code>mtry</code>.</p>
</div>
<div class="section level3">
<h3 id="specifying-arguments">Specifying Arguments<a class="anchor" aria-label="anchor" href="#specifying-arguments"></a>
</h3>
<p>Commonly used arguments to the modeling functions have their
parameters exposed in the function. For example,
<code>rand_forest</code> has arguments for:</p>
<ul>
<li>
<code>mtry</code>: The number of predictors that will be randomly
sampled at each split when creating the tree models.</li>
<li>
<code>trees</code>: The number of trees contained in the
ensemble.</li>
<li>
<code>min_n</code>: The minimum number of data points in a node that
are required for the node to be split further.</li>
</ul>
<p>The arguments to the default function are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/args.html" class="external-link">args</a></span><span class="op">(</span><span class="va">rand_forest</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (mode = "unknown", engine = "ranger", mtry = NULL, trees = NULL, </span></span>
<span><span class="co">#&gt;     min_n = NULL) </span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>However, there might be other arguments that you would like to change
or allow to vary. These are accessible using <code>set_engine</code>.
For example, <code><a href="http://imbs-hl.github.io/ranger/reference/ranger.html" class="external-link">ranger()</a></code> from the ranger package has an option
to set the internal random number seed. To set this to a specific
value:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_with_seed</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/rand_forest.html">rand_forest</a></span><span class="op">(</span>trees <span class="op">=</span> <span class="fl">2000</span>, mtry <span class="op">=</span> <span class="fu"><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune</a></span><span class="op">(</span><span class="op">)</span>, mode <span class="op">=</span> <span class="st">"regression"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span>, seed <span class="op">=</span> <span class="fl">63233</span><span class="op">)</span></span>
<span><span class="va">rf_with_seed</span></span>
<span><span class="co">#&gt; Random Forest Model Specification (regression)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Main Arguments:</span></span>
<span><span class="co">#&gt;   mtry = tune()</span></span>
<span><span class="co">#&gt;   trees = 2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Engine-Specific Arguments:</span></span>
<span><span class="co">#&gt;   seed = 63233</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Computational engine: ranger</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="process">Process<a class="anchor" aria-label="anchor" href="#process"></a>
</h3>
<p>To fit the model, you must:</p>
<ul>
<li>have a defined model, including the <em>mode</em>,</li>
<li>have no <code><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune()</a></code> parameters, and</li>
<li>specify a computational engine.</li>
</ul>
<p>For example, <code>rf_with_seed</code> above is not ready for fitting
due the <code><a href="https://hardhat.tidymodels.org/reference/tune.html" class="external-link">tune()</a></code> parameter. We can set that parameter’s value
and then create the model fit:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rf_with_seed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_args</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"ranger"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; parsnip model object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Ranger result</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  ranger::ranger(x = maybe_data_frame(x), y = y, mtry = min_cols(~4, x), num.trees = ~2000, num.threads = 1, verbose = FALSE, seed = sample.int(10^5, 1)) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type:                             Regression </span></span>
<span><span class="co">#&gt; Number of trees:                  2000 </span></span>
<span><span class="co">#&gt; Sample size:                      32 </span></span>
<span><span class="co">#&gt; Number of independent variables:  10 </span></span>
<span><span class="co">#&gt; Mtry:                             4 </span></span>
<span><span class="co">#&gt; Target node size:                 5 </span></span>
<span><span class="co">#&gt; Variable importance mode:         none </span></span>
<span><span class="co">#&gt; Splitrule:                        variance </span></span>
<span><span class="co">#&gt; OOB prediction error (MSE):       5.57 </span></span>
<span><span class="co">#&gt; R squared (OOB):                  0.847</span></span></code></pre>
<p>Or, using the <code>randomForest</code> package:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">56982</span><span class="op">)</span></span>
<span><span class="va">rf_with_seed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_args.html">set_args</a></span><span class="op">(</span>mtry <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_engine.html">set_engine</a></span><span class="op">(</span><span class="st">"randomForest"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; parsnip model object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt;  randomForest(x = maybe_data_frame(x), y = y, ntree = ~2000, mtry = min_cols(~4, x)) </span></span>
<span><span class="co">#&gt;                Type of random forest: regression</span></span>
<span><span class="co">#&gt;                      Number of trees: 2000</span></span>
<span><span class="co">#&gt; No. of variables tried at each split: 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Mean of squared residuals: 5.52</span></span>
<span><span class="co">#&gt;                     % Var explained: 84.3</span></span></code></pre>
<p>Note that the call objects show <code>num.trees = ~2000</code>. The
tilde is the consequence of <code>parsnip</code> using <a href="https://adv-r.hadley.nz/evaluation.html#quosures" class="external-link">quosures</a> to
process the model specification’s arguments.</p>
<p>Normally, when a function is executed, the function’s arguments are
immediately evaluated. In the case of parsnip, the model specification’s
arguments are <em>not</em>; the <a href="https://www.tidyverse.org/blog/2019/04/parsnip-internals/" class="external-link">expression
is captured</a> along with the environment where it should be evaluated.
That is what a quosure does.</p>
<p>parsnip uses these expressions to make a model fit call that is
evaluated. The tilde in the call above reflects that the argument was
captured using a quosure.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://github.com/DavisVaughan" class="external-link">Davis Vaughan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer>
</body>
</html>
